

============================== 2022-07-07 09:20:32.860088 | d8d7f7c3-cda1-46e1-b69d-38a5d092d21a ==============================
09:20:32.860293 [info ] [MainThread]: Running with dbt=1.1.1
09:20:32.860858 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rashmimishra/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:20:32.860996 [debug] [MainThread]: Tracking: tracking
09:20:32.892793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa039c60950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa039c8cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa039c8c8d0>]}
09:20:32.904291 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
09:20:32.904593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd8d7f7c3-cda1-46e1-b69d-38a5d092d21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa039c60e10>]}
09:20:32.918536 [debug] [MainThread]: Parsing macros/catalog.sql
09:20:32.922005 [debug] [MainThread]: Parsing macros/relations.sql
09:20:32.923427 [debug] [MainThread]: Parsing macros/adapters.sql
09:20:32.944380 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
09:20:32.945862 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
09:20:32.949171 [debug] [MainThread]: Parsing macros/materializations/configs.sql
09:20:32.951136 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
09:20:32.952515 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
09:20:32.967290 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
09:20:32.979233 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
09:20:32.989775 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
09:20:32.993781 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
09:20:32.995280 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
09:20:32.996764 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
09:20:33.000735 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
09:20:33.016279 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
09:20:33.017558 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
09:20:33.026731 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
09:20:33.040881 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
09:20:33.048223 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
09:20:33.050781 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
09:20:33.058035 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
09:20:33.059274 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
09:20:33.061807 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
09:20:33.065627 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
09:20:33.071464 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
09:20:33.087175 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
09:20:33.088478 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
09:20:33.090522 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
09:20:33.091841 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
09:20:33.092607 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
09:20:33.093279 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
09:20:33.093824 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
09:20:33.095687 [debug] [MainThread]: Parsing macros/etc/statement.sql
09:20:33.099604 [debug] [MainThread]: Parsing macros/etc/datetime.sql
09:20:33.107496 [debug] [MainThread]: Parsing macros/adapters/schema.sql
09:20:33.109312 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
09:20:33.111545 [debug] [MainThread]: Parsing macros/adapters/relation.sql
09:20:33.143063 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
09:20:33.145628 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
09:20:33.149651 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
09:20:33.155808 [debug] [MainThread]: Parsing macros/adapters/columns.sql
09:20:33.164303 [debug] [MainThread]: Parsing tests/generic/builtin.sql
09:20:33.315695 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
09:20:33.325875 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
09:20:33.368834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8d7f7c3-cda1-46e1-b69d-38a5d092d21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0398b1f10>]}
09:20:33.373339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8d7f7c3-cda1-46e1-b69d-38a5d092d21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa048e4a650>]}
09:20:33.373663 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
09:20:33.373937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8d7f7c3-cda1-46e1-b69d-38a5d092d21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa048e4ac90>]}
09:20:33.375134 [info ] [MainThread]: 
09:20:33.375571 [debug] [MainThread]: Acquiring new postgres connection "master"
09:20:33.376427 [debug] [ThreadPool]: Acquiring new postgres connection "list_rewards"
09:20:33.386149 [debug] [ThreadPool]: Using postgres connection "list_rewards"
09:20:33.386394 [debug] [ThreadPool]: On list_rewards: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "list_rewards"} */

    select distinct nspname from pg_namespace
  
09:20:33.386505 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:20:33.835872 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.45 seconds
09:20:33.837585 [debug] [ThreadPool]: On list_rewards: Close
09:20:33.838735 [debug] [ThreadPool]: Acquiring new postgres connection "list_rewards_public"
09:20:33.845273 [debug] [ThreadPool]: Using postgres connection "list_rewards_public"
09:20:33.845452 [debug] [ThreadPool]: On list_rewards_public: BEGIN
09:20:33.845589 [debug] [ThreadPool]: Opening a new connection, currently in state closed
09:20:35.177277 [debug] [ThreadPool]: SQL status: BEGIN in 1.33 seconds
09:20:35.178867 [debug] [ThreadPool]: Using postgres connection "list_rewards_public"
09:20:35.179424 [debug] [ThreadPool]: On list_rewards_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "list_rewards_public"} */
select
      'rewards' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'rewards' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
09:20:35.219926 [debug] [ThreadPool]: SQL status: SELECT 88 in 0.04 seconds
09:20:35.226460 [debug] [ThreadPool]: On list_rewards_public: ROLLBACK
09:20:35.265185 [debug] [ThreadPool]: On list_rewards_public: Close
09:20:35.281067 [debug] [MainThread]: Using postgres connection "master"
09:20:35.281404 [debug] [MainThread]: On master: BEGIN
09:20:35.281605 [debug] [MainThread]: Opening a new connection, currently in state init
09:20:35.607688 [debug] [MainThread]: SQL status: BEGIN in 0.33 seconds
09:20:35.609109 [debug] [MainThread]: Using postgres connection "master"
09:20:35.609725 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
09:20:35.647173 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
09:20:35.651954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8d7f7c3-cda1-46e1-b69d-38a5d092d21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa039cb6e50>]}
09:20:35.652746 [debug] [MainThread]: On master: ROLLBACK
09:20:35.685005 [debug] [MainThread]: Using postgres connection "master"
09:20:35.686236 [debug] [MainThread]: On master: BEGIN
09:20:35.755927 [debug] [MainThread]: SQL status: BEGIN in 0.07 seconds
09:20:35.756721 [debug] [MainThread]: On master: COMMIT
09:20:35.757037 [debug] [MainThread]: Using postgres connection "master"
09:20:35.757323 [debug] [MainThread]: On master: COMMIT
09:20:35.791717 [debug] [MainThread]: SQL status: COMMIT in 0.03 seconds
09:20:35.792662 [debug] [MainThread]: On master: Close
09:20:35.794884 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
09:20:35.795810 [info ] [MainThread]: 
09:20:35.801170 [debug] [Thread-1  ]: Began running node model.airbyte_rewards.my_first_dbt_model
09:20:35.801988 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model ............................. [RUN]
09:20:35.802990 [debug] [Thread-1  ]: Acquiring new postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:20:35.803328 [debug] [Thread-1  ]: Began compiling node model.airbyte_rewards.my_first_dbt_model
09:20:35.803591 [debug] [Thread-1  ]: Compiling model.airbyte_rewards.my_first_dbt_model
09:20:35.808832 [debug] [Thread-1  ]: Writing injected SQL for node "model.airbyte_rewards.my_first_dbt_model"
09:20:35.810076 [debug] [Thread-1  ]: finished collecting timing info
09:20:35.810324 [debug] [Thread-1  ]: Began executing node model.airbyte_rewards.my_first_dbt_model
09:20:35.847862 [debug] [Thread-1  ]: Writing runtime SQL for node "model.airbyte_rewards.my_first_dbt_model"
09:20:35.848683 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:20:35.848818 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: BEGIN
09:20:35.848928 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:20:36.548528 [debug] [Thread-1  ]: SQL status: BEGIN in 0.7 seconds
09:20:36.548819 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:20:36.548948 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */


  create  table "rewards"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
09:20:36.583064 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.03 seconds
09:20:36.589909 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:20:36.590125 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */
alter table "rewards"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
09:20:36.631774 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.04 seconds
09:20:36.644433 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: COMMIT
09:20:36.644643 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:20:36.644823 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: COMMIT
09:20:36.681804 [debug] [Thread-1  ]: SQL status: COMMIT in 0.04 seconds
09:20:36.687950 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:20:36.688147 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */
drop table if exists "rewards"."public"."my_first_dbt_model__dbt_backup" cascade
09:20:36.753138 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.06 seconds
09:20:36.754791 [debug] [Thread-1  ]: finished collecting timing info
09:20:36.755076 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: Close
09:20:36.755809 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d7f7c3-cda1-46e1-b69d-38a5d092d21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa039c9ac50>]}
09:20:36.756459 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.95s]
09:20:36.757208 [debug] [Thread-1  ]: Finished running node model.airbyte_rewards.my_first_dbt_model
09:20:36.757775 [debug] [Thread-1  ]: Began running node model.airbyte_rewards.my_second_dbt_model
09:20:36.758192 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model ............................. [RUN]
09:20:36.758903 [debug] [Thread-1  ]: Acquiring new postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:20:36.759159 [debug] [Thread-1  ]: Began compiling node model.airbyte_rewards.my_second_dbt_model
09:20:36.759396 [debug] [Thread-1  ]: Compiling model.airbyte_rewards.my_second_dbt_model
09:20:36.763292 [debug] [Thread-1  ]: Writing injected SQL for node "model.airbyte_rewards.my_second_dbt_model"
09:20:36.764050 [debug] [Thread-1  ]: finished collecting timing info
09:20:36.764278 [debug] [Thread-1  ]: Began executing node model.airbyte_rewards.my_second_dbt_model
09:20:36.791503 [debug] [Thread-1  ]: Writing runtime SQL for node "model.airbyte_rewards.my_second_dbt_model"
09:20:36.792066 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:20:36.792223 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: BEGIN
09:20:36.792355 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:20:37.150105 [debug] [Thread-1  ]: SQL status: BEGIN in 0.36 seconds
09:20:37.151528 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:20:37.151921 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_second_dbt_model"} */

  create view "rewards"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "rewards"."public"."my_first_dbt_model"
where id = 1
  );
09:20:37.205659 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.05 seconds
09:20:37.213166 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:20:37.213707 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_second_dbt_model"} */
alter table "rewards"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
09:20:37.253290 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.04 seconds
09:20:37.257837 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: COMMIT
09:20:37.258129 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:20:37.258260 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: COMMIT
09:20:37.305484 [debug] [Thread-1  ]: SQL status: COMMIT in 0.05 seconds
09:20:37.311681 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:20:37.311931 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_second_dbt_model"} */
drop view if exists "rewards"."public"."my_second_dbt_model__dbt_backup" cascade
09:20:37.348519 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.04 seconds
09:20:37.352886 [debug] [Thread-1  ]: finished collecting timing info
09:20:37.353367 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: Close
09:20:37.354601 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d7f7c3-cda1-46e1-b69d-38a5d092d21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa048ec16d0>]}
09:20:37.355430 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.60s]
09:20:37.356230 [debug] [Thread-1  ]: Finished running node model.airbyte_rewards.my_second_dbt_model
09:20:37.367470 [debug] [MainThread]: Acquiring new postgres connection "master"
09:20:37.367892 [debug] [MainThread]: Using postgres connection "master"
09:20:37.368101 [debug] [MainThread]: On master: BEGIN
09:20:37.368285 [debug] [MainThread]: Opening a new connection, currently in state closed
09:20:37.696706 [debug] [MainThread]: SQL status: BEGIN in 0.33 seconds
09:20:37.698424 [debug] [MainThread]: On master: COMMIT
09:20:37.698896 [debug] [MainThread]: Using postgres connection "master"
09:20:37.699350 [debug] [MainThread]: On master: COMMIT
09:20:37.732683 [debug] [MainThread]: SQL status: COMMIT in 0.03 seconds
09:20:37.734474 [debug] [MainThread]: On master: Close
09:20:37.736983 [info ] [MainThread]: 
09:20:37.737785 [info ] [MainThread]: Finished running 1 table model, 1 view model in 4.36s.
09:20:37.738325 [debug] [MainThread]: Connection 'master' was properly closed.
09:20:37.738602 [debug] [MainThread]: Connection 'model.airbyte_rewards.my_second_dbt_model' was properly closed.
09:20:37.749035 [info ] [MainThread]: 
09:20:37.749527 [info ] [MainThread]: [32mCompleted successfully[0m
09:20:37.749980 [info ] [MainThread]: 
09:20:37.750327 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
09:20:37.750852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa048efe9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa039c8c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa048ef11d0>]}


============================== 2022-07-07 09:25:14.507306 | 74896ef3-5f29-4236-8053-fcd5afe6a573 ==============================
09:25:14.507562 [info ] [MainThread]: Running with dbt=1.1.1
09:25:14.508471 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rashmimishra/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:25:14.508600 [debug] [MainThread]: Tracking: tracking
09:25:14.547368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9069bcebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9069b8cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9069c7f810>]}
09:25:14.565246 [info ] [MainThread]: Unable to do partial parsing because profile has changed
09:25:14.565576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '74896ef3-5f29-4236-8053-fcd5afe6a573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9048899f50>]}
09:25:14.578834 [debug] [MainThread]: Parsing macros/catalog.sql
09:25:14.582465 [debug] [MainThread]: Parsing macros/relations.sql
09:25:14.583701 [debug] [MainThread]: Parsing macros/adapters.sql
09:25:14.604440 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
09:25:14.605866 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
09:25:14.609234 [debug] [MainThread]: Parsing macros/materializations/configs.sql
09:25:14.611270 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
09:25:14.612876 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
09:25:14.652904 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
09:25:14.665398 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
09:25:14.676364 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
09:25:14.680454 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
09:25:14.682194 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
09:25:14.683814 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
09:25:14.687680 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
09:25:14.703010 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
09:25:14.704339 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
09:25:14.714122 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
09:25:14.728796 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
09:25:14.736375 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
09:25:14.738937 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
09:25:14.745964 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
09:25:14.747106 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
09:25:14.749464 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
09:25:14.751570 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
09:25:14.757346 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
09:25:14.772528 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
09:25:14.773874 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
09:25:14.775922 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
09:25:14.777225 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
09:25:14.777936 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
09:25:14.778576 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
09:25:14.779115 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
09:25:14.780392 [debug] [MainThread]: Parsing macros/etc/statement.sql
09:25:14.784467 [debug] [MainThread]: Parsing macros/etc/datetime.sql
09:25:14.792059 [debug] [MainThread]: Parsing macros/adapters/schema.sql
09:25:14.793970 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
09:25:14.796284 [debug] [MainThread]: Parsing macros/adapters/relation.sql
09:25:14.804649 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
09:25:14.807151 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
09:25:14.810941 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
09:25:14.817148 [debug] [MainThread]: Parsing macros/adapters/columns.sql
09:25:14.826020 [debug] [MainThread]: Parsing tests/generic/builtin.sql
09:25:14.987847 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
09:25:14.997233 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
09:25:15.035317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74896ef3-5f29-4236-8053-fcd5afe6a573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904891e590>]}
09:25:15.039329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74896ef3-5f29-4236-8053-fcd5afe6a573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904891eb50>]}
09:25:15.039553 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
09:25:15.039749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74896ef3-5f29-4236-8053-fcd5afe6a573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904891eed0>]}
09:25:15.040832 [info ] [MainThread]: 
09:25:15.041208 [debug] [MainThread]: Acquiring new postgres connection "master"
09:25:15.041786 [debug] [ThreadPool]: Acquiring new postgres connection "list_rewards"
09:25:15.050028 [debug] [ThreadPool]: Using postgres connection "list_rewards"
09:25:15.050258 [debug] [ThreadPool]: On list_rewards: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "list_rewards"} */

    select distinct nspname from pg_namespace
  
09:25:15.050355 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:25:15.399077 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.35 seconds
09:25:15.400573 [debug] [ThreadPool]: On list_rewards: Close
09:25:15.401915 [debug] [ThreadPool]: Acquiring new postgres connection "list_rewards_public"
09:25:15.408172 [debug] [ThreadPool]: Using postgres connection "list_rewards_public"
09:25:15.408378 [debug] [ThreadPool]: On list_rewards_public: BEGIN
09:25:15.408562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
09:25:15.691025 [debug] [ThreadPool]: SQL status: BEGIN in 0.28 seconds
09:25:15.691637 [debug] [ThreadPool]: Using postgres connection "list_rewards_public"
09:25:15.691895 [debug] [ThreadPool]: On list_rewards_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "list_rewards_public"} */
select
      'rewards' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'rewards' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
09:25:15.776539 [debug] [ThreadPool]: SQL status: SELECT 84 in 0.08 seconds
09:25:15.787456 [debug] [ThreadPool]: On list_rewards_public: ROLLBACK
09:25:15.826682 [debug] [ThreadPool]: On list_rewards_public: Close
09:25:15.840986 [debug] [MainThread]: Using postgres connection "master"
09:25:15.841329 [debug] [MainThread]: On master: BEGIN
09:25:15.841529 [debug] [MainThread]: Opening a new connection, currently in state init
09:25:16.117899 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
09:25:16.121940 [debug] [MainThread]: Using postgres connection "master"
09:25:16.122161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
09:25:16.201174 [debug] [MainThread]: SQL status: SELECT 0 in 0.08 seconds
09:25:16.202187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74896ef3-5f29-4236-8053-fcd5afe6a573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9069c78a50>]}
09:25:16.202420 [debug] [MainThread]: On master: ROLLBACK
09:25:16.232418 [debug] [MainThread]: Using postgres connection "master"
09:25:16.232639 [debug] [MainThread]: On master: BEGIN
09:25:16.314607 [debug] [MainThread]: SQL status: BEGIN in 0.08 seconds
09:25:16.314906 [debug] [MainThread]: On master: COMMIT
09:25:16.315041 [debug] [MainThread]: Using postgres connection "master"
09:25:16.315159 [debug] [MainThread]: On master: COMMIT
09:25:16.342166 [debug] [MainThread]: SQL status: COMMIT in 0.03 seconds
09:25:16.342423 [debug] [MainThread]: On master: Close
09:25:16.342889 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
09:25:16.343350 [info ] [MainThread]: 
09:25:16.346032 [debug] [Thread-1  ]: Began running node model.airbyte_rewards.my_first_dbt_model
09:25:16.346370 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model ............................. [RUN]
09:25:16.346793 [debug] [Thread-1  ]: Acquiring new postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:25:16.346933 [debug] [Thread-1  ]: Began compiling node model.airbyte_rewards.my_first_dbt_model
09:25:16.347108 [debug] [Thread-1  ]: Compiling model.airbyte_rewards.my_first_dbt_model
09:25:16.349539 [debug] [Thread-1  ]: Writing injected SQL for node "model.airbyte_rewards.my_first_dbt_model"
09:25:16.350217 [debug] [Thread-1  ]: finished collecting timing info
09:25:16.350424 [debug] [Thread-1  ]: Began executing node model.airbyte_rewards.my_first_dbt_model
09:25:16.380066 [debug] [Thread-1  ]: Writing runtime SQL for node "model.airbyte_rewards.my_first_dbt_model"
09:25:16.380828 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:25:16.380967 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: BEGIN
09:25:16.381071 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:25:16.627820 [debug] [Thread-1  ]: SQL status: BEGIN in 0.25 seconds
09:25:16.628120 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:25:16.628255 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */


  create  table "rewards"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
09:25:16.777283 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.15 seconds
09:25:16.787570 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:25:16.787889 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */
alter table "rewards"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
09:25:16.818444 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
09:25:16.833622 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: COMMIT
09:25:16.833872 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:25:16.834018 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: COMMIT
09:25:16.875927 [debug] [Thread-1  ]: SQL status: COMMIT in 0.04 seconds
09:25:16.881734 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:25:16.881923 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */
drop table if exists "rewards"."public"."my_first_dbt_model__dbt_backup" cascade
09:25:16.907846 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
09:25:16.909142 [debug] [Thread-1  ]: finished collecting timing info
09:25:16.909348 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: Close
09:25:16.909838 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74896ef3-5f29-4236-8053-fcd5afe6a573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9069cc89d0>]}
09:25:16.910211 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.56s]
09:25:16.910649 [debug] [Thread-1  ]: Finished running node model.airbyte_rewards.my_first_dbt_model
09:25:16.911025 [debug] [Thread-1  ]: Began running node model.airbyte_rewards.my_second_dbt_model
09:25:16.911263 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model ............................. [RUN]
09:25:16.911881 [debug] [Thread-1  ]: Acquiring new postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:25:16.912053 [debug] [Thread-1  ]: Began compiling node model.airbyte_rewards.my_second_dbt_model
09:25:16.912211 [debug] [Thread-1  ]: Compiling model.airbyte_rewards.my_second_dbt_model
09:25:16.914630 [debug] [Thread-1  ]: Writing injected SQL for node "model.airbyte_rewards.my_second_dbt_model"
09:25:16.915139 [debug] [Thread-1  ]: finished collecting timing info
09:25:16.915307 [debug] [Thread-1  ]: Began executing node model.airbyte_rewards.my_second_dbt_model
09:25:16.938904 [debug] [Thread-1  ]: Writing runtime SQL for node "model.airbyte_rewards.my_second_dbt_model"
09:25:16.939426 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:25:16.939554 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: BEGIN
09:25:16.939662 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:25:17.229668 [debug] [Thread-1  ]: SQL status: BEGIN in 0.29 seconds
09:25:17.231186 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:25:17.231688 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_second_dbt_model"} */

  create view "rewards"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "rewards"."public"."my_first_dbt_model"
where id = 1
  );
09:25:17.321387 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.09 seconds
09:25:17.331649 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:25:17.332108 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_second_dbt_model"} */
alter table "rewards"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
09:25:17.368795 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.04 seconds
09:25:17.371551 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: COMMIT
09:25:17.371884 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:25:17.372162 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: COMMIT
09:25:17.424174 [debug] [Thread-1  ]: SQL status: COMMIT in 0.05 seconds
09:25:17.430692 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:25:17.431044 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_second_dbt_model"} */
drop view if exists "rewards"."public"."my_second_dbt_model__dbt_backup" cascade
09:25:17.460253 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.03 seconds
09:25:17.464960 [debug] [Thread-1  ]: finished collecting timing info
09:25:17.465417 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: Close
09:25:17.466371 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74896ef3-5f29-4236-8053-fcd5afe6a573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9069cc89d0>]}
09:25:17.467133 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.55s]
09:25:17.467992 [debug] [Thread-1  ]: Finished running node model.airbyte_rewards.my_second_dbt_model
09:25:17.470171 [debug] [MainThread]: Acquiring new postgres connection "master"
09:25:17.470564 [debug] [MainThread]: Using postgres connection "master"
09:25:17.470799 [debug] [MainThread]: On master: BEGIN
09:25:17.471017 [debug] [MainThread]: Opening a new connection, currently in state closed
09:25:17.785263 [debug] [MainThread]: SQL status: BEGIN in 0.31 seconds
09:25:17.785924 [debug] [MainThread]: On master: COMMIT
09:25:17.786177 [debug] [MainThread]: Using postgres connection "master"
09:25:17.786434 [debug] [MainThread]: On master: COMMIT
09:25:17.827225 [debug] [MainThread]: SQL status: COMMIT in 0.04 seconds
09:25:17.828484 [debug] [MainThread]: On master: Close
09:25:17.831135 [info ] [MainThread]: 
09:25:17.832305 [info ] [MainThread]: Finished running 1 table model, 1 view model in 2.79s.
09:25:17.833168 [debug] [MainThread]: Connection 'master' was properly closed.
09:25:17.833497 [debug] [MainThread]: Connection 'model.airbyte_rewards.my_second_dbt_model' was properly closed.
09:25:17.843126 [info ] [MainThread]: 
09:25:17.843741 [info ] [MainThread]: [32mCompleted successfully[0m
09:25:17.844254 [info ] [MainThread]: 
09:25:17.844655 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
09:25:17.845180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9069cc2e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904896b510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904896b210>]}


============================== 2022-07-07 09:35:43.725919 | 3c236fcf-147b-4176-9c82-1acc5f6b158e ==============================
09:35:43.726102 [info ] [MainThread]: Running with dbt=1.1.1
09:35:43.726965 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rashmimishra/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:35:43.727121 [debug] [MainThread]: Tracking: tracking
09:35:43.765807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ca3e6cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ca2ced90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ca3bcd10>]}
09:35:43.793270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
09:35:43.793593 [debug] [MainThread]: Partial parsing: added file: airbyte_rewards://models/example/rewards_db.sql
09:35:43.825727 [debug] [MainThread]: 1699: static parser successfully parsed example/rewards_db.sql
09:35:43.835679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ca32ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ca3ab810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ca3aba10>]}


============================== 2022-07-07 09:39:32.711208 | bcc9fc34-6d0a-4d55-8c8c-5715dc10ab3f ==============================
09:39:32.711406 [info ] [MainThread]: Running with dbt=1.1.1
09:39:32.713084 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rashmimishra/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:39:32.713255 [debug] [MainThread]: Tracking: tracking
09:39:32.752134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa911e51690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa911f22cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa911e76cd0>]}
09:39:32.782432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
09:39:32.782787 [debug] [MainThread]: Partial parsing: added file: airbyte_rewards://models/example/rewards_db.sql
09:39:32.783154 [debug] [MainThread]: Partial parsing: update schema file: airbyte_rewards://models/example/schema.yml
09:39:32.818099 [debug] [MainThread]: 1699: static parser successfully parsed example/rewards_db.sql
09:39:32.858469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa911facd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9182bb350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa91200aad0>]}


============================== 2022-07-07 09:39:48.534062 | 9861cdfc-bdba-44a6-ab76-eb088382119d ==============================
09:39:48.534249 [info ] [MainThread]: Running with dbt=1.1.1
09:39:48.535220 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rashmimishra/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:39:48.535409 [debug] [MainThread]: Tracking: tracking
09:39:48.585514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa42191eb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa421808910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa421925f90>]}
09:39:48.614215 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
09:39:48.614611 [debug] [MainThread]: Partial parsing: added file: airbyte_rewards://models/example/rewards_db.sql
09:39:48.615000 [debug] [MainThread]: Partial parsing: update schema file: airbyte_rewards://models/example/schema.yml
09:39:48.650765 [debug] [MainThread]: 1699: static parser successfully parsed example/rewards_db.sql
09:39:48.675840 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'users' in the 'models' section of file 'models/example/schema.yml'
09:39:48.693986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa42154df50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa430359d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4218224d0>]}


============================== 2022-07-07 09:40:25.511150 | c4a96760-7080-4945-9af3-7d162b865d84 ==============================
09:40:25.511364 [info ] [MainThread]: Running with dbt=1.1.1
09:40:25.512378 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rashmimishra/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:40:25.512530 [debug] [MainThread]: Tracking: tracking
09:40:25.556272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac08081850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac31ec6c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac31ed6190>]}
09:40:25.588159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
09:40:25.588547 [debug] [MainThread]: Partial parsing: added file: airbyte_rewards://models/example/rewards_db.sql
09:40:25.588883 [debug] [MainThread]: Partial parsing: update schema file: airbyte_rewards://models/example/schema.yml
09:40:25.626146 [debug] [MainThread]: 1699: static parser successfully parsed example/rewards_db.sql
09:40:25.650278 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'users' in the 'models' section of file 'models/example/schema.yml'
09:40:25.668072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac20860d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac31ff16d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac31fe1950>]}


============================== 2022-07-07 09:40:39.494710 | c088894a-7e90-4284-ab73-12e6f7b6a7f0 ==============================
09:40:39.494917 [info ] [MainThread]: Running with dbt=1.1.1
09:40:39.497005 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rashmimishra/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:40:39.497491 [debug] [MainThread]: Tracking: tracking
09:40:39.536440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e4221ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e421f9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e421f9750>]}
09:40:39.564204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
09:40:39.564505 [debug] [MainThread]: Partial parsing: added file: airbyte_rewards://models/example/rewards_db.sql
09:40:39.564813 [debug] [MainThread]: Partial parsing: update schema file: airbyte_rewards://models/example/schema.yml
09:40:39.596728 [debug] [MainThread]: 1699: static parser successfully parsed example/rewards_db.sql
09:40:39.620059 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'users' in the 'models' section of file 'models/example/schema.yml'
09:40:39.637821 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.airbyte_rewards.unique_users_id.ec952d9777' (models/example/schema.yml) depends on a node named 'users' which was not found
09:40:39.638058 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.airbyte_rewards.not_null_users_id.4db5ed5c63' (models/example/schema.yml) depends on a node named 'users' which was not found
09:40:39.638227 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.airbyte_rewards.unique_users_user_id.dff2f1fba5' (models/example/schema.yml) depends on a node named 'users' which was not found
09:40:39.638385 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.airbyte_rewards.not_null_users_user_id.fa10ab166c' (models/example/schema.yml) depends on a node named 'users' which was not found
09:40:39.638545 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.airbyte_rewards.unique_users_email.8545c2f7ee' (models/example/schema.yml) depends on a node named 'users' which was not found
09:40:39.638712 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.airbyte_rewards.not_null_users_email.f0068076e4' (models/example/schema.yml) depends on a node named 'users' which was not found
09:40:39.649628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c088894a-7e90-4284-ab73-12e6f7b6a7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e422def50>]}
09:40:39.655009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c088894a-7e90-4284-ab73-12e6f7b6a7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e4230aed0>]}
09:40:39.655282 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
09:40:39.655486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c088894a-7e90-4284-ab73-12e6f7b6a7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e4230afd0>]}
09:40:39.656693 [info ] [MainThread]: 
09:40:39.657062 [debug] [MainThread]: Acquiring new postgres connection "master"
09:40:39.657826 [debug] [ThreadPool]: Acquiring new postgres connection "list_rewards"
09:40:39.666247 [debug] [ThreadPool]: Using postgres connection "list_rewards"
09:40:39.666441 [debug] [ThreadPool]: On list_rewards: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "list_rewards"} */

    select distinct nspname from pg_namespace
  
09:40:39.666545 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:40:49.672829 [debug] [ThreadPool]: Postgres adapter: Got an error when attempting to open a postgres connection: 'connection to server at "10.69.224.231", port 5432 failed: timeout expired
'
09:40:49.676895 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "list_rewards"} */

    select distinct nspname from pg_namespace
  
09:40:49.677600 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
09:40:49.678537 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
09:40:49.678931 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
09:40:49.679327 [debug] [ThreadPool]: On list_rewards: No close available on handle
09:40:49.680684 [debug] [MainThread]: Connection 'master' was properly closed.
09:40:49.681002 [debug] [MainThread]: Connection 'list_rewards' was properly closed.
09:40:49.681807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e42378610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e42378b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e423785d0>]}


============================== 2022-07-07 09:41:38.963364 | de20cfea-3c12-48eb-867d-c3b943df8727 ==============================
09:41:38.963627 [info ] [MainThread]: Running with dbt=1.1.1
09:41:38.964600 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rashmimishra/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:41:38.964760 [debug] [MainThread]: Tracking: tracking
09:41:38.998253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf2100a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf20d6ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf20d6e90>]}
09:41:39.028754 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
09:41:39.028941 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
09:41:39.055728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de20cfea-3c12-48eb-867d-c3b943df8727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf20b3f90>]}
09:41:39.060248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de20cfea-3c12-48eb-867d-c3b943df8727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd10826b50>]}
09:41:39.060463 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
09:41:39.060676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de20cfea-3c12-48eb-867d-c3b943df8727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd108268d0>]}
09:41:39.061768 [info ] [MainThread]: 
09:41:39.062099 [debug] [MainThread]: Acquiring new postgres connection "master"
09:41:39.062807 [debug] [ThreadPool]: Acquiring new postgres connection "list_rewards"
09:41:39.071450 [debug] [ThreadPool]: Using postgres connection "list_rewards"
09:41:39.071660 [debug] [ThreadPool]: On list_rewards: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "list_rewards"} */

    select distinct nspname from pg_namespace
  
09:41:39.071763 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:41:49.077984 [debug] [ThreadPool]: Postgres adapter: Got an error when attempting to open a postgres connection: 'connection to server at "10.69.224.231", port 5432 failed: timeout expired
'
09:41:49.081519 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "list_rewards"} */

    select distinct nspname from pg_namespace
  
09:41:49.081970 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
09:41:49.082606 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
09:41:49.082902 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
09:41:49.083351 [debug] [ThreadPool]: On list_rewards: No close available on handle
09:41:49.085404 [debug] [MainThread]: Connection 'master' was properly closed.
09:41:49.086188 [debug] [MainThread]: Connection 'list_rewards' was properly closed.
09:41:49.087233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf20deb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf20de2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf20de590>]}


============================== 2022-07-07 09:50:07.606795 | b01f4f20-dd3d-401e-833d-976d99f57216 ==============================
09:50:07.606980 [info ] [MainThread]: Running with dbt=1.1.1
09:50:07.607689 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rashmimishra/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:50:07.607831 [debug] [MainThread]: Tracking: tracking
09:50:07.643880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c82140d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c82212c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c821666d0>]}
09:50:07.660304 [info ] [MainThread]: Unable to do partial parsing because profile has changed
09:50:07.660612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b01f4f20-dd3d-401e-833d-976d99f57216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c70129fd0>]}
09:50:07.674424 [debug] [MainThread]: Parsing macros/catalog.sql
09:50:07.677835 [debug] [MainThread]: Parsing macros/relations.sql
09:50:07.679112 [debug] [MainThread]: Parsing macros/adapters.sql
09:50:07.720801 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
09:50:07.722354 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
09:50:07.725629 [debug] [MainThread]: Parsing macros/materializations/configs.sql
09:50:07.727577 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
09:50:07.728948 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
09:50:07.743962 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
09:50:07.756025 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
09:50:07.766746 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
09:50:07.771010 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
09:50:07.772780 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
09:50:07.774401 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
09:50:07.778396 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
09:50:07.794041 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
09:50:07.795378 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
09:50:07.804503 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
09:50:07.818252 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
09:50:07.825211 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
09:50:07.827571 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
09:50:07.834063 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
09:50:07.835109 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
09:50:07.837387 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
09:50:07.839238 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
09:50:07.844614 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
09:50:07.859156 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
09:50:07.860391 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
09:50:07.862678 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
09:50:07.864079 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
09:50:07.864818 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
09:50:07.865479 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
09:50:07.866028 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
09:50:07.867328 [debug] [MainThread]: Parsing macros/etc/statement.sql
09:50:07.871116 [debug] [MainThread]: Parsing macros/etc/datetime.sql
09:50:07.879013 [debug] [MainThread]: Parsing macros/adapters/schema.sql
09:50:07.880868 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
09:50:07.883129 [debug] [MainThread]: Parsing macros/adapters/relation.sql
09:50:07.891218 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
09:50:07.893606 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
09:50:07.897274 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
09:50:07.903322 [debug] [MainThread]: Parsing macros/adapters/columns.sql
09:50:07.911566 [debug] [MainThread]: Parsing tests/generic/builtin.sql
09:50:08.066303 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
09:50:08.075726 [debug] [MainThread]: 1699: static parser successfully parsed example/rewards_db.sql
09:50:08.077473 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
09:50:08.099959 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'users' in the 'models' section of file 'models/example/schema.yml'
09:50:08.124302 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.airbyte_rewards.unique_users_id.ec952d9777' (models/example/schema.yml) depends on a node named 'users' which was not found
09:50:08.124536 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.airbyte_rewards.not_null_users_id.4db5ed5c63' (models/example/schema.yml) depends on a node named 'users' which was not found
09:50:08.124702 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.airbyte_rewards.unique_users_user_id.dff2f1fba5' (models/example/schema.yml) depends on a node named 'users' which was not found
09:50:08.124862 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.airbyte_rewards.not_null_users_user_id.fa10ab166c' (models/example/schema.yml) depends on a node named 'users' which was not found
09:50:08.125021 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.airbyte_rewards.unique_users_email.8545c2f7ee' (models/example/schema.yml) depends on a node named 'users' which was not found
09:50:08.125187 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.airbyte_rewards.not_null_users_email.f0068076e4' (models/example/schema.yml) depends on a node named 'users' which was not found
09:50:08.140239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b01f4f20-dd3d-401e-833d-976d99f57216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c82280850>]}
09:50:08.144675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b01f4f20-dd3d-401e-833d-976d99f57216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8228f4d0>]}
09:50:08.144894 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
09:50:08.145089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b01f4f20-dd3d-401e-833d-976d99f57216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c821dbc10>]}
09:50:08.146531 [info ] [MainThread]: 
09:50:08.146924 [debug] [MainThread]: Acquiring new postgres connection "master"
09:50:08.147694 [debug] [ThreadPool]: Acquiring new postgres connection "list_rewards"
09:50:08.156012 [debug] [ThreadPool]: Using postgres connection "list_rewards"
09:50:08.156151 [debug] [ThreadPool]: On list_rewards: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "list_rewards"} */

    select distinct nspname from pg_namespace
  
09:50:08.156246 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:50:08.500561 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.34 seconds
09:50:08.505515 [debug] [ThreadPool]: On list_rewards: Close
09:50:08.508197 [debug] [ThreadPool]: Acquiring new postgres connection "list_rewards_public"
09:50:08.519148 [debug] [ThreadPool]: Using postgres connection "list_rewards_public"
09:50:08.519419 [debug] [ThreadPool]: On list_rewards_public: BEGIN
09:50:08.519600 [debug] [ThreadPool]: Opening a new connection, currently in state closed
09:50:08.811149 [debug] [ThreadPool]: SQL status: BEGIN in 0.29 seconds
09:50:08.812859 [debug] [ThreadPool]: Using postgres connection "list_rewards_public"
09:50:08.813249 [debug] [ThreadPool]: On list_rewards_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "list_rewards_public"} */
select
      'rewards' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'rewards' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
09:50:08.935743 [debug] [ThreadPool]: SQL status: SELECT 84 in 0.12 seconds
09:50:08.948675 [debug] [ThreadPool]: On list_rewards_public: ROLLBACK
09:50:08.978738 [debug] [ThreadPool]: On list_rewards_public: Close
09:50:08.990305 [debug] [MainThread]: Using postgres connection "master"
09:50:08.990583 [debug] [MainThread]: On master: BEGIN
09:50:08.990788 [debug] [MainThread]: Opening a new connection, currently in state init
09:50:09.283550 [debug] [MainThread]: SQL status: BEGIN in 0.29 seconds
09:50:09.284292 [debug] [MainThread]: Using postgres connection "master"
09:50:09.284603 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
09:50:09.596698 [debug] [MainThread]: SQL status: SELECT 0 in 0.31 seconds
09:50:09.597792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b01f4f20-dd3d-401e-833d-976d99f57216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8229be10>]}
09:50:09.598076 [debug] [MainThread]: On master: ROLLBACK
09:50:09.628256 [debug] [MainThread]: Using postgres connection "master"
09:50:09.628526 [debug] [MainThread]: On master: BEGIN
09:50:09.685779 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
09:50:09.686049 [debug] [MainThread]: On master: COMMIT
09:50:09.686158 [debug] [MainThread]: Using postgres connection "master"
09:50:09.686254 [debug] [MainThread]: On master: COMMIT
09:50:09.716363 [debug] [MainThread]: SQL status: COMMIT in 0.03 seconds
09:50:09.716589 [debug] [MainThread]: On master: Close
09:50:09.716975 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
09:50:09.717179 [info ] [MainThread]: 
09:50:09.718965 [debug] [Thread-1  ]: Began running node model.airbyte_rewards.my_first_dbt_model
09:50:09.719231 [info ] [Thread-1  ]: 1 of 3 START table model public.my_first_dbt_model ............................. [RUN]
09:50:09.719589 [debug] [Thread-1  ]: Acquiring new postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:50:09.719707 [debug] [Thread-1  ]: Began compiling node model.airbyte_rewards.my_first_dbt_model
09:50:09.719820 [debug] [Thread-1  ]: Compiling model.airbyte_rewards.my_first_dbt_model
09:50:09.722076 [debug] [Thread-1  ]: Writing injected SQL for node "model.airbyte_rewards.my_first_dbt_model"
09:50:09.722555 [debug] [Thread-1  ]: finished collecting timing info
09:50:09.722686 [debug] [Thread-1  ]: Began executing node model.airbyte_rewards.my_first_dbt_model
09:50:09.750712 [debug] [Thread-1  ]: Writing runtime SQL for node "model.airbyte_rewards.my_first_dbt_model"
09:50:09.751472 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:50:09.751648 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: BEGIN
09:50:09.751753 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:50:10.059746 [debug] [Thread-1  ]: SQL status: BEGIN in 0.31 seconds
09:50:10.060065 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:50:10.060248 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */


  create  table "rewards"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
09:50:10.255109 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.19 seconds
09:50:10.270729 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:50:10.271088 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */
alter table "rewards"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
09:50:10.303993 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
09:50:10.318702 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: COMMIT
09:50:10.318895 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:50:10.319048 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: COMMIT
09:50:10.351969 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
09:50:10.358332 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:50:10.358568 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */
drop table if exists "rewards"."public"."my_first_dbt_model__dbt_backup" cascade
09:50:10.392230 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
09:50:10.393864 [debug] [Thread-1  ]: finished collecting timing info
09:50:10.394150 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: Close
09:50:10.394909 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b01f4f20-dd3d-401e-833d-976d99f57216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c701972d0>]}
09:50:10.395480 [info ] [Thread-1  ]: 1 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.68s]
09:50:10.396119 [debug] [Thread-1  ]: Finished running node model.airbyte_rewards.my_first_dbt_model
09:50:10.396399 [debug] [Thread-1  ]: Began running node model.airbyte_rewards.rewards_db
09:50:10.396696 [info ] [Thread-1  ]: 2 of 3 START table model public.rewards_db ..................................... [RUN]
09:50:10.397264 [debug] [Thread-1  ]: Acquiring new postgres connection "model.airbyte_rewards.rewards_db"
09:50:10.397483 [debug] [Thread-1  ]: Began compiling node model.airbyte_rewards.rewards_db
09:50:10.397696 [debug] [Thread-1  ]: Compiling model.airbyte_rewards.rewards_db
09:50:10.400999 [debug] [Thread-1  ]: Writing injected SQL for node "model.airbyte_rewards.rewards_db"
09:50:10.402093 [debug] [Thread-1  ]: finished collecting timing info
09:50:10.402346 [debug] [Thread-1  ]: Began executing node model.airbyte_rewards.rewards_db
09:50:10.409359 [debug] [Thread-1  ]: Writing runtime SQL for node "model.airbyte_rewards.rewards_db"
09:50:10.410197 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_db"
09:50:10.410367 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: BEGIN
09:50:10.410507 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:50:10.710872 [debug] [Thread-1  ]: SQL status: BEGIN in 0.3 seconds
09:50:10.712601 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_db"
09:50:10.713296 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.rewards_db"} */


  create  table "rewards"."public"."rewards_db__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- with source_data as (

--     select 1 as id
--     union all
--     select null as id

-- )

select
  id, user_id, first_name, last_name, email, contact, gender, to_timestamp(dob), "location", latitude, longitude, work_status, preferred_languages, is_mother, family_type, interests, durables, to_timestamp(created_time), to_timestamp(updated_time), is_deleted, profession_type, income_slab, device_details, is_email_verified, referral_code, referred_by, state_name, is_email_invalid, is_rewards_disabled, rewards_app_login, is_expecting, helpdesk_membership_id, city, user_tags, rfm_cluster_score
from users

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
09:50:10.745778 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "to_timestamp" specified more than once

09:50:10.746765 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: ROLLBACK
09:50:10.777045 [debug] [Thread-1  ]: finished collecting timing info
09:50:10.778281 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: Close
09:50:10.779685 [debug] [Thread-1  ]: Database Error in model rewards_db (models/example/rewards_db.sql)
  column "to_timestamp" specified more than once
  compiled SQL at target/run/airbyte_rewards/models/example/rewards_db.sql
09:50:10.780503 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b01f4f20-dd3d-401e-833d-976d99f57216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c7009c0d0>]}
09:50:10.781372 [error] [Thread-1  ]: 2 of 3 ERROR creating table model public.rewards_db ............................ [[31mERROR[0m in 0.38s]
09:50:10.782257 [debug] [Thread-1  ]: Finished running node model.airbyte_rewards.rewards_db
09:50:10.782669 [debug] [Thread-1  ]: Began running node model.airbyte_rewards.my_second_dbt_model
09:50:10.783530 [info ] [Thread-1  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
09:50:10.784465 [debug] [Thread-1  ]: Acquiring new postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:50:10.784741 [debug] [Thread-1  ]: Began compiling node model.airbyte_rewards.my_second_dbt_model
09:50:10.785002 [debug] [Thread-1  ]: Compiling model.airbyte_rewards.my_second_dbt_model
09:50:10.789991 [debug] [Thread-1  ]: Writing injected SQL for node "model.airbyte_rewards.my_second_dbt_model"
09:50:10.791071 [debug] [Thread-1  ]: finished collecting timing info
09:50:10.791320 [debug] [Thread-1  ]: Began executing node model.airbyte_rewards.my_second_dbt_model
09:50:10.819178 [debug] [Thread-1  ]: Writing runtime SQL for node "model.airbyte_rewards.my_second_dbt_model"
09:50:10.819715 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:50:10.819834 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: BEGIN
09:50:10.819930 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:50:11.145173 [debug] [Thread-1  ]: SQL status: BEGIN in 0.33 seconds
09:50:11.146740 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:50:11.147082 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_second_dbt_model"} */

  create view "rewards"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "rewards"."public"."my_first_dbt_model"
where id = 1
  );
09:50:11.230328 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.08 seconds
09:50:11.239882 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:50:11.240288 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_second_dbt_model"} */
alter table "rewards"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
09:50:11.269712 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
09:50:11.271805 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: COMMIT
09:50:11.272058 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:50:11.272277 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: COMMIT
09:50:11.303276 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
09:50:11.310600 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:50:11.311268 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_second_dbt_model"} */
drop view if exists "rewards"."public"."my_second_dbt_model__dbt_backup" cascade
09:50:11.342675 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.03 seconds
09:50:11.344767 [debug] [Thread-1  ]: finished collecting timing info
09:50:11.345135 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: Close
09:50:11.346112 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b01f4f20-dd3d-401e-833d-976d99f57216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c70197410>]}
09:50:11.346832 [info ] [Thread-1  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.56s]
09:50:11.347553 [debug] [Thread-1  ]: Finished running node model.airbyte_rewards.my_second_dbt_model
09:50:11.374822 [debug] [MainThread]: Acquiring new postgres connection "master"
09:50:11.375311 [debug] [MainThread]: Using postgres connection "master"
09:50:11.375481 [debug] [MainThread]: On master: BEGIN
09:50:11.375625 [debug] [MainThread]: Opening a new connection, currently in state closed
09:50:11.662000 [debug] [MainThread]: SQL status: BEGIN in 0.29 seconds
09:50:11.662559 [debug] [MainThread]: On master: COMMIT
09:50:11.662755 [debug] [MainThread]: Using postgres connection "master"
09:50:11.662933 [debug] [MainThread]: On master: COMMIT
09:50:11.928988 [debug] [MainThread]: SQL status: COMMIT in 0.27 seconds
09:50:11.929759 [debug] [MainThread]: On master: Close
09:50:11.930986 [info ] [MainThread]: 
09:50:11.931585 [info ] [MainThread]: Finished running 2 table models, 1 view model in 3.78s.
09:50:11.932099 [debug] [MainThread]: Connection 'master' was properly closed.
09:50:11.932371 [debug] [MainThread]: Connection 'model.airbyte_rewards.my_second_dbt_model' was properly closed.
09:50:11.944066 [info ] [MainThread]: 
09:50:11.944532 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
09:50:11.944925 [info ] [MainThread]: 
09:50:11.945259 [error] [MainThread]: [33mDatabase Error in model rewards_db (models/example/rewards_db.sql)[0m
09:50:11.945593 [error] [MainThread]:   column "to_timestamp" specified more than once
09:50:11.945906 [error] [MainThread]:   compiled SQL at target/run/airbyte_rewards/models/example/rewards_db.sql
09:50:11.946311 [info ] [MainThread]: 
09:50:11.946768 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
09:50:11.947299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c701b0a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c700cb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c700cb390>]}


============================== 2022-07-07 09:51:21.691965 | 817b0f4c-c29e-42c4-acde-676212746802 ==============================
09:51:21.692178 [info ] [MainThread]: Running with dbt=1.1.1
09:51:21.693441 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rashmimishra/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:51:21.693604 [debug] [MainThread]: Tracking: tracking
09:51:21.729631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde38677a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde5a479f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde38677cd0>]}
09:51:21.758097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
09:51:21.758602 [debug] [MainThread]: Partial parsing: update schema file: airbyte_rewards://models/example/schema.yml
09:51:21.824559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '817b0f4c-c29e-42c4-acde-676212746802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde38670110>]}
09:51:21.829013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '817b0f4c-c29e-42c4-acde-676212746802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde5a47b810>]}
09:51:21.829207 [info ] [MainThread]: Found 3 models, 10 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
09:51:21.829406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '817b0f4c-c29e-42c4-acde-676212746802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde5a47b690>]}
09:51:21.830528 [info ] [MainThread]: 
09:51:21.830881 [debug] [MainThread]: Acquiring new postgres connection "master"
09:51:21.831618 [debug] [ThreadPool]: Acquiring new postgres connection "list_rewards"
09:51:21.839799 [debug] [ThreadPool]: Using postgres connection "list_rewards"
09:51:21.840006 [debug] [ThreadPool]: On list_rewards: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "list_rewards"} */

    select distinct nspname from pg_namespace
  
09:51:21.840105 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:51:22.172284 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.33 seconds
09:51:22.175278 [debug] [ThreadPool]: On list_rewards: Close
09:51:22.177577 [debug] [ThreadPool]: Acquiring new postgres connection "list_rewards_public"
09:51:22.187215 [debug] [ThreadPool]: Using postgres connection "list_rewards_public"
09:51:22.187453 [debug] [ThreadPool]: On list_rewards_public: BEGIN
09:51:22.187630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
09:51:22.472182 [debug] [ThreadPool]: SQL status: BEGIN in 0.28 seconds
09:51:22.472749 [debug] [ThreadPool]: Using postgres connection "list_rewards_public"
09:51:22.472997 [debug] [ThreadPool]: On list_rewards_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "list_rewards_public"} */
select
      'rewards' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'rewards' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
09:51:22.509914 [debug] [ThreadPool]: SQL status: SELECT 86 in 0.04 seconds
09:51:22.519888 [debug] [ThreadPool]: On list_rewards_public: ROLLBACK
09:51:22.547530 [debug] [ThreadPool]: On list_rewards_public: Close
09:51:22.555125 [debug] [MainThread]: Using postgres connection "master"
09:51:22.555342 [debug] [MainThread]: On master: BEGIN
09:51:22.555484 [debug] [MainThread]: Opening a new connection, currently in state init
09:51:22.844360 [debug] [MainThread]: SQL status: BEGIN in 0.29 seconds
09:51:22.846067 [debug] [MainThread]: Using postgres connection "master"
09:51:22.846395 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
09:51:22.940568 [debug] [MainThread]: SQL status: SELECT 1 in 0.09 seconds
09:51:22.945662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '817b0f4c-c29e-42c4-acde-676212746802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde5a453f90>]}
09:51:22.946427 [debug] [MainThread]: On master: ROLLBACK
09:51:22.977120 [debug] [MainThread]: Using postgres connection "master"
09:51:22.977512 [debug] [MainThread]: On master: BEGIN
09:51:23.034773 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
09:51:23.035928 [debug] [MainThread]: On master: COMMIT
09:51:23.036492 [debug] [MainThread]: Using postgres connection "master"
09:51:23.036989 [debug] [MainThread]: On master: COMMIT
09:51:23.066168 [debug] [MainThread]: SQL status: COMMIT in 0.03 seconds
09:51:23.067383 [debug] [MainThread]: On master: Close
09:51:23.069830 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
09:51:23.071164 [info ] [MainThread]: 
09:51:23.076523 [debug] [Thread-1  ]: Began running node model.airbyte_rewards.my_first_dbt_model
09:51:23.077302 [info ] [Thread-1  ]: 1 of 3 START table model public.my_first_dbt_model ............................. [RUN]
09:51:23.078266 [debug] [Thread-1  ]: Acquiring new postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:51:23.078561 [debug] [Thread-1  ]: Began compiling node model.airbyte_rewards.my_first_dbt_model
09:51:23.078837 [debug] [Thread-1  ]: Compiling model.airbyte_rewards.my_first_dbt_model
09:51:23.083872 [debug] [Thread-1  ]: Writing injected SQL for node "model.airbyte_rewards.my_first_dbt_model"
09:51:23.084789 [debug] [Thread-1  ]: finished collecting timing info
09:51:23.085055 [debug] [Thread-1  ]: Began executing node model.airbyte_rewards.my_first_dbt_model
09:51:23.122199 [debug] [Thread-1  ]: Writing runtime SQL for node "model.airbyte_rewards.my_first_dbt_model"
09:51:23.122750 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:51:23.122880 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: BEGIN
09:51:23.122991 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:51:23.404147 [debug] [Thread-1  ]: SQL status: BEGIN in 0.28 seconds
09:51:23.405185 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:51:23.405563 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */


  create  table "rewards"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
09:51:23.457345 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.05 seconds
09:51:23.475030 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:51:23.475404 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */
alter table "rewards"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
09:51:23.505966 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
09:51:23.510076 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:51:23.510354 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */
alter table "rewards"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
09:51:23.549952 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.04 seconds
09:51:23.573687 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: COMMIT
09:51:23.573974 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:51:23.574158 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: COMMIT
09:51:23.605976 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
09:51:23.613574 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:51:23.613824 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */
drop table if exists "rewards"."public"."my_first_dbt_model__dbt_backup" cascade
09:51:23.707382 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.09 seconds
09:51:23.712701 [debug] [Thread-1  ]: finished collecting timing info
09:51:23.713183 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: Close
09:51:23.714220 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '817b0f4c-c29e-42c4-acde-676212746802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde38750fd0>]}
09:51:23.715003 [info ] [Thread-1  ]: 1 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.64s]
09:51:23.715817 [debug] [Thread-1  ]: Finished running node model.airbyte_rewards.my_first_dbt_model
09:51:23.716143 [debug] [Thread-1  ]: Began running node model.airbyte_rewards.rewards_db
09:51:23.716713 [info ] [Thread-1  ]: 2 of 3 START table model public.rewards_db ..................................... [RUN]
09:51:23.717989 [debug] [Thread-1  ]: Acquiring new postgres connection "model.airbyte_rewards.rewards_db"
09:51:23.718402 [debug] [Thread-1  ]: Began compiling node model.airbyte_rewards.rewards_db
09:51:23.718691 [debug] [Thread-1  ]: Compiling model.airbyte_rewards.rewards_db
09:51:23.725390 [debug] [Thread-1  ]: Writing injected SQL for node "model.airbyte_rewards.rewards_db"
09:51:23.726304 [debug] [Thread-1  ]: finished collecting timing info
09:51:23.726565 [debug] [Thread-1  ]: Began executing node model.airbyte_rewards.rewards_db
09:51:23.734280 [debug] [Thread-1  ]: Writing runtime SQL for node "model.airbyte_rewards.rewards_db"
09:51:23.734923 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_db"
09:51:23.735111 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: BEGIN
09:51:23.735258 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:51:24.016525 [debug] [Thread-1  ]: SQL status: BEGIN in 0.28 seconds
09:51:24.018704 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_db"
09:51:24.019022 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.rewards_db"} */


  create  table "rewards"."public"."rewards_db__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- with source_data as (

--     select 1 as id
--     union all
--     select null as id

-- )

select
  id, user_id, first_name, last_name, email, contact, gender, to_timestamp(dob), "location", latitude, longitude, work_status, preferred_languages, is_mother, family_type, interests, durables, to_timestamp(created_time), to_timestamp(updated_time), is_deleted, profession_type, income_slab, device_details, is_email_verified, referral_code, referred_by, state_name, is_email_invalid, is_rewards_disabled, rewards_app_login, is_expecting, helpdesk_membership_id, city, user_tags, rfm_cluster_score
from users

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
09:51:24.050289 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "to_timestamp" specified more than once

09:51:24.051648 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: ROLLBACK
09:51:24.090595 [debug] [Thread-1  ]: finished collecting timing info
09:51:24.091680 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: Close
09:51:24.093880 [debug] [Thread-1  ]: Database Error in model rewards_db (models/example/rewards_db.sql)
  column "to_timestamp" specified more than once
  compiled SQL at target/run/airbyte_rewards/models/example/rewards_db.sql
09:51:24.094837 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '817b0f4c-c29e-42c4-acde-676212746802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4818a890>]}
09:51:24.095591 [error] [Thread-1  ]: 2 of 3 ERROR creating table model public.rewards_db ............................ [[31mERROR[0m in 0.38s]
09:51:24.096670 [debug] [Thread-1  ]: Finished running node model.airbyte_rewards.rewards_db
09:51:24.097091 [debug] [Thread-1  ]: Began running node model.airbyte_rewards.my_second_dbt_model
09:51:24.097499 [info ] [Thread-1  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
09:51:24.098195 [debug] [Thread-1  ]: Acquiring new postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:51:24.099142 [debug] [Thread-1  ]: Began compiling node model.airbyte_rewards.my_second_dbt_model
09:51:24.099497 [debug] [Thread-1  ]: Compiling model.airbyte_rewards.my_second_dbt_model
09:51:24.103790 [debug] [Thread-1  ]: Writing injected SQL for node "model.airbyte_rewards.my_second_dbt_model"
09:51:24.104691 [debug] [Thread-1  ]: finished collecting timing info
09:51:24.104919 [debug] [Thread-1  ]: Began executing node model.airbyte_rewards.my_second_dbt_model
09:51:24.131033 [debug] [Thread-1  ]: Writing runtime SQL for node "model.airbyte_rewards.my_second_dbt_model"
09:51:24.131567 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:51:24.131706 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: BEGIN
09:51:24.131824 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:51:24.430233 [debug] [Thread-1  ]: SQL status: BEGIN in 0.3 seconds
09:51:24.430531 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:51:24.430664 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_second_dbt_model"} */

  create view "rewards"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "rewards"."public"."my_first_dbt_model"
where id = 1
  );
09:51:24.461723 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.03 seconds
09:51:24.464261 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:51:24.464443 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_second_dbt_model"} */
alter table "rewards"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
09:51:24.496118 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
09:51:24.497466 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: COMMIT
09:51:24.497648 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:51:24.497799 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: COMMIT
09:51:24.527299 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
09:51:24.529192 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:51:24.529357 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_second_dbt_model"} */
drop view if exists "rewards"."public"."my_second_dbt_model__dbt_backup" cascade
09:51:24.560438 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.03 seconds
09:51:24.561704 [debug] [Thread-1  ]: finished collecting timing info
09:51:24.561925 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: Close
09:51:24.562494 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '817b0f4c-c29e-42c4-acde-676212746802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4818a0d0>]}
09:51:24.562930 [info ] [Thread-1  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.46s]
09:51:24.563408 [debug] [Thread-1  ]: Finished running node model.airbyte_rewards.my_second_dbt_model
09:51:24.644866 [debug] [MainThread]: Acquiring new postgres connection "master"
09:51:24.645468 [debug] [MainThread]: Using postgres connection "master"
09:51:24.645635 [debug] [MainThread]: On master: BEGIN
09:51:24.645786 [debug] [MainThread]: Opening a new connection, currently in state closed
09:51:24.928162 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
09:51:24.928840 [debug] [MainThread]: On master: COMMIT
09:51:24.929063 [debug] [MainThread]: Using postgres connection "master"
09:51:24.929267 [debug] [MainThread]: On master: COMMIT
09:51:25.194769 [debug] [MainThread]: SQL status: COMMIT in 0.27 seconds
09:51:25.196559 [debug] [MainThread]: On master: Close
09:51:25.199412 [info ] [MainThread]: 
09:51:25.200269 [info ] [MainThread]: Finished running 2 table models, 1 view model in 3.37s.
09:51:25.200847 [debug] [MainThread]: Connection 'master' was properly closed.
09:51:25.201131 [debug] [MainThread]: Connection 'model.airbyte_rewards.my_second_dbt_model' was properly closed.
09:51:25.211987 [info ] [MainThread]: 
09:51:25.212594 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
09:51:25.213060 [info ] [MainThread]: 
09:51:25.213705 [error] [MainThread]: [33mDatabase Error in model rewards_db (models/example/rewards_db.sql)[0m
09:51:25.214284 [error] [MainThread]:   column "to_timestamp" specified more than once
09:51:25.214623 [error] [MainThread]:   compiled SQL at target/run/airbyte_rewards/models/example/rewards_db.sql
09:51:25.214993 [info ] [MainThread]: 
09:51:25.215352 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
09:51:25.215881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde481af390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde38746dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde481a6250>]}


============================== 2022-07-07 09:51:46.917281 | 02c5ab22-7697-4c89-8b0e-e5d1003f2d64 ==============================
09:51:46.917466 [info ] [MainThread]: Running with dbt=1.1.1
09:51:46.918181 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rashmimishra/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:51:46.918314 [debug] [MainThread]: Tracking: tracking
09:51:46.953444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf5a29cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf5a249f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf5a249f90>]}
09:51:46.982978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
09:51:46.983535 [debug] [MainThread]: Partial parsing: update schema file: airbyte_rewards://models/example/schema.yml
09:51:47.015340 [debug] [MainThread]: 1699: static parser successfully parsed example/rewards_db.sql
09:51:47.062330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02c5ab22-7697-4c89-8b0e-e5d1003f2d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf5a15e390>]}
09:51:47.066603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02c5ab22-7697-4c89-8b0e-e5d1003f2d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf381aebd0>]}
09:51:47.066801 [info ] [MainThread]: Found 3 models, 10 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
09:51:47.066998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02c5ab22-7697-4c89-8b0e-e5d1003f2d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf381aeb50>]}
09:51:47.068150 [info ] [MainThread]: 
09:51:47.068489 [debug] [MainThread]: Acquiring new postgres connection "master"
09:51:47.069123 [debug] [ThreadPool]: Acquiring new postgres connection "list_rewards"
09:51:47.077261 [debug] [ThreadPool]: Using postgres connection "list_rewards"
09:51:47.077469 [debug] [ThreadPool]: On list_rewards: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "list_rewards"} */

    select distinct nspname from pg_namespace
  
09:51:47.077570 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:51:47.442725 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.36 seconds
09:51:47.445839 [debug] [ThreadPool]: On list_rewards: Close
09:51:47.448035 [debug] [ThreadPool]: Acquiring new postgres connection "list_rewards_public"
09:51:47.457361 [debug] [ThreadPool]: Using postgres connection "list_rewards_public"
09:51:47.457603 [debug] [ThreadPool]: On list_rewards_public: BEGIN
09:51:47.457777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
09:51:47.751000 [debug] [ThreadPool]: SQL status: BEGIN in 0.29 seconds
09:51:47.752266 [debug] [ThreadPool]: Using postgres connection "list_rewards_public"
09:51:47.752784 [debug] [ThreadPool]: On list_rewards_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "list_rewards_public"} */
select
      'rewards' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'rewards' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
09:51:47.787350 [debug] [ThreadPool]: SQL status: SELECT 86 in 0.03 seconds
09:51:47.799263 [debug] [ThreadPool]: On list_rewards_public: ROLLBACK
09:51:47.830081 [debug] [ThreadPool]: On list_rewards_public: Close
09:51:47.846422 [debug] [MainThread]: Using postgres connection "master"
09:51:47.846721 [debug] [MainThread]: On master: BEGIN
09:51:47.846919 [debug] [MainThread]: Opening a new connection, currently in state init
09:51:48.237103 [debug] [MainThread]: SQL status: BEGIN in 0.39 seconds
09:51:48.238943 [debug] [MainThread]: Using postgres connection "master"
09:51:48.239607 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
09:51:48.277463 [debug] [MainThread]: SQL status: SELECT 1 in 0.04 seconds
09:51:48.282904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02c5ab22-7697-4c89-8b0e-e5d1003f2d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf381ae7d0>]}
09:51:48.283758 [debug] [MainThread]: On master: ROLLBACK
09:51:48.313657 [debug] [MainThread]: Using postgres connection "master"
09:51:48.314875 [debug] [MainThread]: On master: BEGIN
09:51:48.377125 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
09:51:48.378219 [debug] [MainThread]: On master: COMMIT
09:51:48.378905 [debug] [MainThread]: Using postgres connection "master"
09:51:48.379507 [debug] [MainThread]: On master: COMMIT
09:51:48.407789 [debug] [MainThread]: SQL status: COMMIT in 0.03 seconds
09:51:48.408950 [debug] [MainThread]: On master: Close
09:51:48.411243 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
09:51:48.412558 [info ] [MainThread]: 
09:51:48.419260 [debug] [Thread-1  ]: Began running node model.airbyte_rewards.my_first_dbt_model
09:51:48.420234 [info ] [Thread-1  ]: 1 of 3 START table model public.my_first_dbt_model ............................. [RUN]
09:51:48.421515 [debug] [Thread-1  ]: Acquiring new postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:51:48.421811 [debug] [Thread-1  ]: Began compiling node model.airbyte_rewards.my_first_dbt_model
09:51:48.422083 [debug] [Thread-1  ]: Compiling model.airbyte_rewards.my_first_dbt_model
09:51:48.427118 [debug] [Thread-1  ]: Writing injected SQL for node "model.airbyte_rewards.my_first_dbt_model"
09:51:48.427924 [debug] [Thread-1  ]: finished collecting timing info
09:51:48.428178 [debug] [Thread-1  ]: Began executing node model.airbyte_rewards.my_first_dbt_model
09:51:48.467957 [debug] [Thread-1  ]: Writing runtime SQL for node "model.airbyte_rewards.my_first_dbt_model"
09:51:48.468504 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:51:48.468632 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: BEGIN
09:51:48.468743 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:51:48.740498 [debug] [Thread-1  ]: SQL status: BEGIN in 0.27 seconds
09:51:48.740744 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:51:48.740854 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */


  create  table "rewards"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
09:51:48.775228 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.03 seconds
09:51:48.781421 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:51:48.781578 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */
alter table "rewards"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
09:51:48.811855 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
09:51:48.814000 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:51:48.814145 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */
alter table "rewards"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
09:51:48.844187 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
09:51:48.856020 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: COMMIT
09:51:48.856195 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:51:48.856317 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: COMMIT
09:51:48.884804 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
09:51:48.889722 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:51:48.889889 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */
drop table if exists "rewards"."public"."my_first_dbt_model__dbt_backup" cascade
09:51:48.923002 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
09:51:48.924326 [debug] [Thread-1  ]: finished collecting timing info
09:51:48.924520 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: Close
09:51:48.925004 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c5ab22-7697-4c89-8b0e-e5d1003f2d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf38063510>]}
09:51:48.925437 [info ] [Thread-1  ]: 1 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.50s]
09:51:48.925840 [debug] [Thread-1  ]: Finished running node model.airbyte_rewards.my_first_dbt_model
09:51:48.926008 [debug] [Thread-1  ]: Began running node model.airbyte_rewards.rewards_db
09:51:48.926386 [info ] [Thread-1  ]: 2 of 3 START table model public.rewards_db ..................................... [RUN]
09:51:48.926982 [debug] [Thread-1  ]: Acquiring new postgres connection "model.airbyte_rewards.rewards_db"
09:51:48.927170 [debug] [Thread-1  ]: Began compiling node model.airbyte_rewards.rewards_db
09:51:48.927306 [debug] [Thread-1  ]: Compiling model.airbyte_rewards.rewards_db
09:51:48.929967 [debug] [Thread-1  ]: Writing injected SQL for node "model.airbyte_rewards.rewards_db"
09:51:48.930442 [debug] [Thread-1  ]: finished collecting timing info
09:51:48.930574 [debug] [Thread-1  ]: Began executing node model.airbyte_rewards.rewards_db
09:51:48.935393 [debug] [Thread-1  ]: Writing runtime SQL for node "model.airbyte_rewards.rewards_db"
09:51:48.935685 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_db"
09:51:48.935803 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: BEGIN
09:51:48.935905 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:51:49.217874 [debug] [Thread-1  ]: SQL status: BEGIN in 0.28 seconds
09:51:49.220728 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_db"
09:51:49.221182 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.rewards_db"} */


  create  table "rewards"."public"."rewards_db__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- with source_data as (

--     select 1 as id
--     union all
--     select null as id

-- )

select
  id, user_id, first_name, last_name, email, contact, gender, to_timestamp(dob), "location", latitude, longitude, work_status, preferred_languages, is_mother, family_type, interests, durables, to_timestamp(created_time), to_timestamp(updated_time), is_deleted, profession_type, income_slab, device_details, is_email_verified, referral_code, referred_by, state_name, is_email_invalid, is_rewards_disabled, rewards_app_login, is_expecting, helpdesk_membership_id, city, user_tags, rfm_cluster_score
from users

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
09:51:49.256392 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "to_timestamp" specified more than once

09:51:49.256950 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: ROLLBACK
09:51:49.286358 [debug] [Thread-1  ]: finished collecting timing info
09:51:49.286675 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: Close
09:51:49.287772 [debug] [Thread-1  ]: Database Error in model rewards_db (models/example/rewards_db.sql)
  column "to_timestamp" specified more than once
  compiled SQL at target/run/airbyte_rewards/models/example/rewards_db.sql
09:51:49.288276 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c5ab22-7697-4c89-8b0e-e5d1003f2d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf5a309ed0>]}
09:51:49.288884 [error] [Thread-1  ]: 2 of 3 ERROR creating table model public.rewards_db ............................ [[31mERROR[0m in 0.36s]
09:51:49.289567 [debug] [Thread-1  ]: Finished running node model.airbyte_rewards.rewards_db
09:51:49.289796 [debug] [Thread-1  ]: Began running node model.airbyte_rewards.my_second_dbt_model
09:51:49.290031 [info ] [Thread-1  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
09:51:49.290493 [debug] [Thread-1  ]: Acquiring new postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:51:49.290670 [debug] [Thread-1  ]: Began compiling node model.airbyte_rewards.my_second_dbt_model
09:51:49.290849 [debug] [Thread-1  ]: Compiling model.airbyte_rewards.my_second_dbt_model
09:51:49.294688 [debug] [Thread-1  ]: Writing injected SQL for node "model.airbyte_rewards.my_second_dbt_model"
09:51:49.295545 [debug] [Thread-1  ]: finished collecting timing info
09:51:49.295758 [debug] [Thread-1  ]: Began executing node model.airbyte_rewards.my_second_dbt_model
09:51:49.321963 [debug] [Thread-1  ]: Writing runtime SQL for node "model.airbyte_rewards.my_second_dbt_model"
09:51:49.322497 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:51:49.322636 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: BEGIN
09:51:49.322752 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:51:49.604506 [debug] [Thread-1  ]: SQL status: BEGIN in 0.28 seconds
09:51:49.606330 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:51:49.606682 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_second_dbt_model"} */

  create view "rewards"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "rewards"."public"."my_first_dbt_model"
where id = 1
  );
09:51:49.638448 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.03 seconds
09:51:49.644553 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:51:49.644845 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_second_dbt_model"} */
alter table "rewards"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
09:51:49.678847 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
09:51:49.684252 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: COMMIT
09:51:49.684611 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:51:49.684744 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: COMMIT
09:51:49.714488 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
09:51:49.721996 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:51:49.722440 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_second_dbt_model"} */
drop view if exists "rewards"."public"."my_second_dbt_model__dbt_backup" cascade
09:51:49.751212 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.03 seconds
09:51:49.757023 [debug] [Thread-1  ]: finished collecting timing info
09:51:49.757934 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: Close
09:51:49.760107 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c5ab22-7697-4c89-8b0e-e5d1003f2d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf5a309590>]}
09:51:49.761294 [info ] [Thread-1  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.47s]
09:51:49.762296 [debug] [Thread-1  ]: Finished running node model.airbyte_rewards.my_second_dbt_model
09:51:49.775424 [debug] [MainThread]: Acquiring new postgres connection "master"
09:51:49.775896 [debug] [MainThread]: Using postgres connection "master"
09:51:49.776108 [debug] [MainThread]: On master: BEGIN
09:51:49.776293 [debug] [MainThread]: Opening a new connection, currently in state closed
09:51:50.060769 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
09:51:50.062569 [debug] [MainThread]: On master: COMMIT
09:51:50.063297 [debug] [MainThread]: Using postgres connection "master"
09:51:50.063947 [debug] [MainThread]: On master: COMMIT
09:51:50.093370 [debug] [MainThread]: SQL status: COMMIT in 0.03 seconds
09:51:50.094909 [debug] [MainThread]: On master: Close
09:51:50.097759 [info ] [MainThread]: 
09:51:50.099173 [info ] [MainThread]: Finished running 2 table models, 1 view model in 3.03s.
09:51:50.099993 [debug] [MainThread]: Connection 'master' was properly closed.
09:51:50.100290 [debug] [MainThread]: Connection 'model.airbyte_rewards.my_second_dbt_model' was properly closed.
09:51:50.112655 [info ] [MainThread]: 
09:51:50.113149 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
09:51:50.113538 [info ] [MainThread]: 
09:51:50.113866 [error] [MainThread]: [33mDatabase Error in model rewards_db (models/example/rewards_db.sql)[0m
09:51:50.114192 [error] [MainThread]:   column "to_timestamp" specified more than once
09:51:50.114798 [error] [MainThread]:   compiled SQL at target/run/airbyte_rewards/models/example/rewards_db.sql
09:51:50.115215 [info ] [MainThread]: 
09:51:50.115562 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
09:51:50.116017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf688ffe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf688ffcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf688ffc90>]}


============================== 2022-07-07 09:55:40.325211 | 83bb174f-3cae-45de-8339-6501e31e4934 ==============================
09:55:40.325392 [info ] [MainThread]: Running with dbt=1.1.1
09:55:40.326287 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rashmimishra/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:55:40.326423 [debug] [MainThread]: Tracking: tracking
09:55:40.370662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ea328a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ea300ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ea300f90>]}
09:55:40.402068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
09:55:40.402493 [debug] [MainThread]: Partial parsing: updated file: airbyte_rewards://models/example/rewards_db.sql
09:55:40.433833 [debug] [MainThread]: 1699: static parser successfully parsed example/rewards_db.sql
09:55:40.480065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83bb174f-3cae-45de-8339-6501e31e4934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1c0035a50>]}
09:55:40.484492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83bb174f-3cae-45de-8339-6501e31e4934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b8222b10>]}
09:55:40.484719 [info ] [MainThread]: Found 3 models, 10 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
09:55:40.484924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83bb174f-3cae-45de-8339-6501e31e4934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b8222b10>]}
09:55:40.486077 [info ] [MainThread]: 
09:55:40.486405 [debug] [MainThread]: Acquiring new postgres connection "master"
09:55:40.487149 [debug] [ThreadPool]: Acquiring new postgres connection "list_rewards"
09:55:40.495686 [debug] [ThreadPool]: Using postgres connection "list_rewards"
09:55:40.495875 [debug] [ThreadPool]: On list_rewards: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "list_rewards"} */

    select distinct nspname from pg_namespace
  
09:55:40.495974 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:55:40.846823 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.35 seconds
09:55:40.850355 [debug] [ThreadPool]: On list_rewards: Close
09:55:40.852785 [debug] [ThreadPool]: Acquiring new postgres connection "list_rewards_public"
09:55:40.863397 [debug] [ThreadPool]: Using postgres connection "list_rewards_public"
09:55:40.863660 [debug] [ThreadPool]: On list_rewards_public: BEGIN
09:55:40.863858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
09:55:41.159876 [debug] [ThreadPool]: SQL status: BEGIN in 0.3 seconds
09:55:41.160754 [debug] [ThreadPool]: Using postgres connection "list_rewards_public"
09:55:41.161069 [debug] [ThreadPool]: On list_rewards_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "list_rewards_public"} */
select
      'rewards' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'rewards' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
09:55:41.197004 [debug] [ThreadPool]: SQL status: SELECT 86 in 0.04 seconds
09:55:41.206898 [debug] [ThreadPool]: On list_rewards_public: ROLLBACK
09:55:41.236229 [debug] [ThreadPool]: On list_rewards_public: Close
09:55:41.245736 [debug] [MainThread]: Using postgres connection "master"
09:55:41.245943 [debug] [MainThread]: On master: BEGIN
09:55:41.246044 [debug] [MainThread]: Opening a new connection, currently in state init
09:55:41.581641 [debug] [MainThread]: SQL status: BEGIN in 0.34 seconds
09:55:41.583419 [debug] [MainThread]: Using postgres connection "master"
09:55:41.583940 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
09:55:41.629280 [debug] [MainThread]: SQL status: SELECT 1 in 0.04 seconds
09:55:41.633880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83bb174f-3cae-45de-8339-6501e31e4934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ea37a210>]}
09:55:41.634642 [debug] [MainThread]: On master: ROLLBACK
09:55:41.666683 [debug] [MainThread]: Using postgres connection "master"
09:55:41.668083 [debug] [MainThread]: On master: BEGIN
09:55:41.729933 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
09:55:41.732435 [debug] [MainThread]: On master: COMMIT
09:55:41.733209 [debug] [MainThread]: Using postgres connection "master"
09:55:41.733825 [debug] [MainThread]: On master: COMMIT
09:55:41.767733 [debug] [MainThread]: SQL status: COMMIT in 0.03 seconds
09:55:41.769004 [debug] [MainThread]: On master: Close
09:55:41.771697 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
09:55:41.773330 [info ] [MainThread]: 
09:55:41.778031 [debug] [Thread-1  ]: Began running node model.airbyte_rewards.my_first_dbt_model
09:55:41.778622 [info ] [Thread-1  ]: 1 of 3 START table model public.my_first_dbt_model ............................. [RUN]
09:55:41.779451 [debug] [Thread-1  ]: Acquiring new postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:55:41.779729 [debug] [Thread-1  ]: Began compiling node model.airbyte_rewards.my_first_dbt_model
09:55:41.780003 [debug] [Thread-1  ]: Compiling model.airbyte_rewards.my_first_dbt_model
09:55:41.785011 [debug] [Thread-1  ]: Writing injected SQL for node "model.airbyte_rewards.my_first_dbt_model"
09:55:41.785977 [debug] [Thread-1  ]: finished collecting timing info
09:55:41.786230 [debug] [Thread-1  ]: Began executing node model.airbyte_rewards.my_first_dbt_model
09:55:41.824519 [debug] [Thread-1  ]: Writing runtime SQL for node "model.airbyte_rewards.my_first_dbt_model"
09:55:41.825283 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:55:41.825416 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: BEGIN
09:55:41.825529 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:55:42.109103 [debug] [Thread-1  ]: SQL status: BEGIN in 0.28 seconds
09:55:42.110656 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:55:42.111129 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */


  create  table "rewards"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
09:55:42.154981 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.04 seconds
09:55:42.171278 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:55:42.171600 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */
alter table "rewards"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
09:55:42.200379 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
09:55:42.203290 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:55:42.203454 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */
alter table "rewards"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
09:55:42.235839 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
09:55:42.252322 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: COMMIT
09:55:42.252528 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:55:42.252682 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: COMMIT
09:55:42.281623 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
09:55:42.288026 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:55:42.288222 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */
drop table if exists "rewards"."public"."my_first_dbt_model__dbt_backup" cascade
09:55:42.322333 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
09:55:42.323786 [debug] [Thread-1  ]: finished collecting timing info
09:55:42.324043 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: Close
09:55:42.324669 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83bb174f-3cae-45de-8339-6501e31e4934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ea412650>]}
09:55:42.325152 [info ] [Thread-1  ]: 1 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.55s]
09:55:42.325710 [debug] [Thread-1  ]: Finished running node model.airbyte_rewards.my_first_dbt_model
09:55:42.325974 [debug] [Thread-1  ]: Began running node model.airbyte_rewards.rewards_db
09:55:42.326269 [info ] [Thread-1  ]: 2 of 3 START table model public.rewards_db ..................................... [RUN]
09:55:42.326824 [debug] [Thread-1  ]: Acquiring new postgres connection "model.airbyte_rewards.rewards_db"
09:55:42.327042 [debug] [Thread-1  ]: Began compiling node model.airbyte_rewards.rewards_db
09:55:42.327491 [debug] [Thread-1  ]: Compiling model.airbyte_rewards.rewards_db
09:55:42.331688 [debug] [Thread-1  ]: Writing injected SQL for node "model.airbyte_rewards.rewards_db"
09:55:42.332584 [debug] [Thread-1  ]: finished collecting timing info
09:55:42.332791 [debug] [Thread-1  ]: Began executing node model.airbyte_rewards.rewards_db
09:55:42.339531 [debug] [Thread-1  ]: Writing runtime SQL for node "model.airbyte_rewards.rewards_db"
09:55:42.339929 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_db"
09:55:42.340082 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: BEGIN
09:55:42.340219 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:55:42.630355 [debug] [Thread-1  ]: SQL status: BEGIN in 0.29 seconds
09:55:42.631798 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_db"
09:55:42.632380 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.rewards_db"} */


  create  table "rewards"."public"."rewards_db__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- with source_data as (

--     select 1 as id
--     union all
--     select null as id

-- )

select
  id, user_id, first_name, last_name, email, contact, gender, to_timestamp(dob) as dob, location, latitude, longitude, work_status, preferred_languages, is_mother, family_type, interests, durables, to_timestamp(created_time) as created_time, to_timestamp(updated_time) as updated_time, is_deleted, profession_type, income_slab, device_details, is_email_verified, referral_code, referred_by, state_name, is_email_invalid, is_rewards_disabled, rewards_app_login, is_expecting, helpdesk_membership_id, city, user_tags, rfm_cluster_score
from users;

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
09:55:42.666052 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 26: from users;
                   ^

09:55:42.666914 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: ROLLBACK
09:55:42.700493 [debug] [Thread-1  ]: finished collecting timing info
09:55:42.703017 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: Close
09:55:42.705039 [debug] [Thread-1  ]: Database Error in model rewards_db (models/example/rewards_db.sql)
  syntax error at or near ";"
  LINE 26: from users;
                     ^
  compiled SQL at target/run/airbyte_rewards/models/example/rewards_db.sql
09:55:42.706100 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83bb174f-3cae-45de-8339-6501e31e4934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d824cd50>]}
09:55:42.707239 [error] [Thread-1  ]: 2 of 3 ERROR creating table model public.rewards_db ............................ [[31mERROR[0m in 0.38s]
09:55:42.708100 [debug] [Thread-1  ]: Finished running node model.airbyte_rewards.rewards_db
09:55:42.708389 [debug] [Thread-1  ]: Began running node model.airbyte_rewards.my_second_dbt_model
09:55:42.708684 [info ] [Thread-1  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
09:55:42.709612 [debug] [Thread-1  ]: Acquiring new postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:55:42.709842 [debug] [Thread-1  ]: Began compiling node model.airbyte_rewards.my_second_dbt_model
09:55:42.710057 [debug] [Thread-1  ]: Compiling model.airbyte_rewards.my_second_dbt_model
09:55:42.713785 [debug] [Thread-1  ]: Writing injected SQL for node "model.airbyte_rewards.my_second_dbt_model"
09:55:42.714656 [debug] [Thread-1  ]: finished collecting timing info
09:55:42.714937 [debug] [Thread-1  ]: Began executing node model.airbyte_rewards.my_second_dbt_model
09:55:42.745161 [debug] [Thread-1  ]: Writing runtime SQL for node "model.airbyte_rewards.my_second_dbt_model"
09:55:42.745737 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:55:42.745886 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: BEGIN
09:55:42.746016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:55:43.029113 [debug] [Thread-1  ]: SQL status: BEGIN in 0.28 seconds
09:55:43.029556 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:55:43.029726 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_second_dbt_model"} */

  create view "rewards"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "rewards"."public"."my_first_dbt_model"
where id = 1
  );
09:55:43.062180 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.03 seconds
09:55:43.064590 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:55:43.064761 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_second_dbt_model"} */
alter table "rewards"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
09:55:43.094957 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
09:55:43.096011 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: COMMIT
09:55:43.096140 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:55:43.096240 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: COMMIT
09:55:43.126210 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
09:55:43.127664 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:55:43.127780 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_second_dbt_model"} */
drop view if exists "rewards"."public"."my_second_dbt_model__dbt_backup" cascade
09:55:43.157351 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.03 seconds
09:55:43.158237 [debug] [Thread-1  ]: finished collecting timing info
09:55:43.158385 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: Close
09:55:43.158742 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83bb174f-3cae-45de-8339-6501e31e4934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ea3e3510>]}
09:55:43.159023 [info ] [Thread-1  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.45s]
09:55:43.159351 [debug] [Thread-1  ]: Finished running node model.airbyte_rewards.my_second_dbt_model
09:55:43.244398 [debug] [MainThread]: Acquiring new postgres connection "master"
09:55:43.244644 [debug] [MainThread]: Using postgres connection "master"
09:55:43.244750 [debug] [MainThread]: On master: BEGIN
09:55:43.244844 [debug] [MainThread]: Opening a new connection, currently in state closed
09:55:43.521774 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
09:55:43.523770 [debug] [MainThread]: On master: COMMIT
09:55:43.524418 [debug] [MainThread]: Using postgres connection "master"
09:55:43.525071 [debug] [MainThread]: On master: COMMIT
09:55:43.556943 [debug] [MainThread]: SQL status: COMMIT in 0.03 seconds
09:55:43.558055 [debug] [MainThread]: On master: Close
09:55:43.560715 [info ] [MainThread]: 
09:55:43.562083 [info ] [MainThread]: Finished running 2 table models, 1 view model in 3.07s.
09:55:43.563229 [debug] [MainThread]: Connection 'master' was properly closed.
09:55:43.563823 [debug] [MainThread]: Connection 'model.airbyte_rewards.my_second_dbt_model' was properly closed.
09:55:43.576509 [info ] [MainThread]: 
09:55:43.577012 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
09:55:43.577373 [info ] [MainThread]: 
09:55:43.577666 [error] [MainThread]: [33mDatabase Error in model rewards_db (models/example/rewards_db.sql)[0m
09:55:43.578408 [error] [MainThread]:   syntax error at or near ";"
09:55:43.578721 [error] [MainThread]:   LINE 26: from users;
09:55:43.579007 [error] [MainThread]:                      ^
09:55:43.579282 [error] [MainThread]:   compiled SQL at target/run/airbyte_rewards/models/example/rewards_db.sql
09:55:43.579592 [info ] [MainThread]: 
09:55:43.579890 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
09:55:43.580334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1c05540d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d8256dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d8256fd0>]}


============================== 2022-07-07 09:55:51.466331 | 62b56425-226d-40fc-9cac-6d9fca188305 ==============================
09:55:51.466523 [info ] [MainThread]: Running with dbt=1.1.1
09:55:51.467268 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rashmimishra/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:55:51.467443 [debug] [MainThread]: Tracking: tracking
09:55:51.503203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0d9f38fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0d9f5ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0d9f5e090>]}
09:55:51.531415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
09:55:51.531795 [debug] [MainThread]: Partial parsing: updated file: airbyte_rewards://models/example/rewards_db.sql
09:55:51.561199 [debug] [MainThread]: 1699: static parser successfully parsed example/rewards_db.sql
09:55:51.606945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62b56425-226d-40fc-9cac-6d9fca188305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0d9e9bc50>]}
09:55:51.611107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62b56425-226d-40fc-9cac-6d9fca188305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0f829ded0>]}
09:55:51.611305 [info ] [MainThread]: Found 3 models, 10 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
09:55:51.611503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62b56425-226d-40fc-9cac-6d9fca188305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0f829dd50>]}
09:55:51.612603 [info ] [MainThread]: 
09:55:51.612969 [debug] [MainThread]: Acquiring new postgres connection "master"
09:55:51.613622 [debug] [ThreadPool]: Acquiring new postgres connection "list_rewards"
09:55:51.622107 [debug] [ThreadPool]: Using postgres connection "list_rewards"
09:55:51.622308 [debug] [ThreadPool]: On list_rewards: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "list_rewards"} */

    select distinct nspname from pg_namespace
  
09:55:51.622416 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:55:51.933010 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.31 seconds
09:55:51.936431 [debug] [ThreadPool]: On list_rewards: Close
09:55:51.938824 [debug] [ThreadPool]: Acquiring new postgres connection "list_rewards_public"
09:55:51.949370 [debug] [ThreadPool]: Using postgres connection "list_rewards_public"
09:55:51.949638 [debug] [ThreadPool]: On list_rewards_public: BEGIN
09:55:51.949838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
09:55:52.371051 [debug] [ThreadPool]: SQL status: BEGIN in 0.42 seconds
09:55:52.372505 [debug] [ThreadPool]: Using postgres connection "list_rewards_public"
09:55:52.374137 [debug] [ThreadPool]: On list_rewards_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "list_rewards_public"} */
select
      'rewards' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'rewards' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
09:55:52.413060 [debug] [ThreadPool]: SQL status: SELECT 86 in 0.04 seconds
09:55:52.424354 [debug] [ThreadPool]: On list_rewards_public: ROLLBACK
09:55:52.465428 [debug] [ThreadPool]: On list_rewards_public: Close
09:55:52.481617 [debug] [MainThread]: Using postgres connection "master"
09:55:52.481954 [debug] [MainThread]: On master: BEGIN
09:55:52.482187 [debug] [MainThread]: Opening a new connection, currently in state init
09:55:52.794055 [debug] [MainThread]: SQL status: BEGIN in 0.31 seconds
09:55:52.795883 [debug] [MainThread]: Using postgres connection "master"
09:55:52.796567 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
09:55:52.838014 [debug] [MainThread]: SQL status: SELECT 1 in 0.04 seconds
09:55:52.845172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62b56425-226d-40fc-9cac-6d9fca188305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0da021ad0>]}
09:55:52.846278 [debug] [MainThread]: On master: ROLLBACK
09:55:52.881451 [debug] [MainThread]: Using postgres connection "master"
09:55:52.882552 [debug] [MainThread]: On master: BEGIN
09:55:52.950663 [debug] [MainThread]: SQL status: BEGIN in 0.07 seconds
09:55:52.951777 [debug] [MainThread]: On master: COMMIT
09:55:52.952532 [debug] [MainThread]: Using postgres connection "master"
09:55:52.953161 [debug] [MainThread]: On master: COMMIT
09:55:52.990323 [debug] [MainThread]: SQL status: COMMIT in 0.04 seconds
09:55:52.991502 [debug] [MainThread]: On master: Close
09:55:52.994184 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
09:55:52.995547 [info ] [MainThread]: 
09:55:53.001928 [debug] [Thread-1  ]: Began running node model.airbyte_rewards.my_first_dbt_model
09:55:53.002794 [info ] [Thread-1  ]: 1 of 3 START table model public.my_first_dbt_model ............................. [RUN]
09:55:53.003766 [debug] [Thread-1  ]: Acquiring new postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:55:53.004051 [debug] [Thread-1  ]: Began compiling node model.airbyte_rewards.my_first_dbt_model
09:55:53.004337 [debug] [Thread-1  ]: Compiling model.airbyte_rewards.my_first_dbt_model
09:55:53.009349 [debug] [Thread-1  ]: Writing injected SQL for node "model.airbyte_rewards.my_first_dbt_model"
09:55:53.010200 [debug] [Thread-1  ]: finished collecting timing info
09:55:53.010455 [debug] [Thread-1  ]: Began executing node model.airbyte_rewards.my_first_dbt_model
09:55:53.050026 [debug] [Thread-1  ]: Writing runtime SQL for node "model.airbyte_rewards.my_first_dbt_model"
09:55:53.050620 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:55:53.050757 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: BEGIN
09:55:53.050868 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:55:53.368374 [debug] [Thread-1  ]: SQL status: BEGIN in 0.32 seconds
09:55:53.368598 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:55:53.368711 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */


  create  table "rewards"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
09:55:53.408407 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.04 seconds
09:55:53.414645 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:55:53.414802 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */
alter table "rewards"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
09:55:53.445921 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
09:55:53.448351 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:55:53.448521 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */
alter table "rewards"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
09:55:53.476836 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
09:55:53.486109 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: COMMIT
09:55:53.486291 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:55:53.486400 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: COMMIT
09:55:53.519281 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
09:55:53.523759 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_first_dbt_model"
09:55:53.523899 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_first_dbt_model"} */
drop table if exists "rewards"."public"."my_first_dbt_model__dbt_backup" cascade
09:55:53.556822 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
09:55:53.558129 [debug] [Thread-1  ]: finished collecting timing info
09:55:53.558356 [debug] [Thread-1  ]: On model.airbyte_rewards.my_first_dbt_model: Close
09:55:53.558793 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62b56425-226d-40fc-9cac-6d9fca188305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0da0855d0>]}
09:55:53.559108 [info ] [Thread-1  ]: 1 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.56s]
09:55:53.559450 [debug] [Thread-1  ]: Finished running node model.airbyte_rewards.my_first_dbt_model
09:55:53.559592 [debug] [Thread-1  ]: Began running node model.airbyte_rewards.rewards_db
09:55:53.559947 [info ] [Thread-1  ]: 2 of 3 START table model public.rewards_db ..................................... [RUN]
09:55:53.560385 [debug] [Thread-1  ]: Acquiring new postgres connection "model.airbyte_rewards.rewards_db"
09:55:53.560519 [debug] [Thread-1  ]: Began compiling node model.airbyte_rewards.rewards_db
09:55:53.560634 [debug] [Thread-1  ]: Compiling model.airbyte_rewards.rewards_db
09:55:53.563118 [debug] [Thread-1  ]: Writing injected SQL for node "model.airbyte_rewards.rewards_db"
09:55:53.563534 [debug] [Thread-1  ]: finished collecting timing info
09:55:53.563677 [debug] [Thread-1  ]: Began executing node model.airbyte_rewards.rewards_db
09:55:53.568405 [debug] [Thread-1  ]: Writing runtime SQL for node "model.airbyte_rewards.rewards_db"
09:55:53.568867 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_db"
09:55:53.568979 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: BEGIN
09:55:53.569074 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:55:53.873636 [debug] [Thread-1  ]: SQL status: BEGIN in 0.3 seconds
09:55:53.874274 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_db"
09:55:53.874495 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.rewards_db"} */


  create  table "rewards"."public"."rewards_db__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- with source_data as (

--     select 1 as id
--     union all
--     select null as id

-- )

select
  id, user_id, first_name, last_name, email, contact, gender, to_timestamp(dob) as dob, location, latitude, longitude, work_status, preferred_languages, is_mother, family_type, interests, durables, to_timestamp(created_time) as created_time, to_timestamp(updated_time) as updated_time, is_deleted, profession_type, income_slab, device_details, is_email_verified, referral_code, referred_by, state_name, is_email_invalid, is_rewards_disabled, rewards_app_login, is_expecting, helpdesk_membership_id, city, user_tags, rfm_cluster_score
from users

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
09:55:55.311769 [debug] [Thread-1  ]: SQL status: SELECT 285877 in 1.44 seconds
09:55:55.319337 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_db"
09:55:55.319726 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.rewards_db"} */
alter table "rewards"."public"."rewards_db__dbt_tmp" rename to "rewards_db"
09:55:55.348124 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
09:55:55.355154 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: COMMIT
09:55:55.355880 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_db"
09:55:55.356498 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: COMMIT
09:55:55.437665 [debug] [Thread-1  ]: SQL status: COMMIT in 0.08 seconds
09:55:55.440991 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_db"
09:55:55.441272 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.rewards_db"} */
drop table if exists "rewards"."public"."rewards_db__dbt_backup" cascade
09:55:55.469659 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
09:55:55.471929 [debug] [Thread-1  ]: finished collecting timing info
09:55:55.472317 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_db: Close
09:55:55.473294 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62b56425-226d-40fc-9cac-6d9fca188305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0c803ded0>]}
09:55:55.474049 [info ] [Thread-1  ]: 2 of 3 OK created table model public.rewards_db ................................ [[32mSELECT 285877[0m in 1.91s]
09:55:55.475102 [debug] [Thread-1  ]: Finished running node model.airbyte_rewards.rewards_db
09:55:55.475449 [debug] [Thread-1  ]: Began running node model.airbyte_rewards.my_second_dbt_model
09:55:55.475964 [info ] [Thread-1  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
09:55:55.476748 [debug] [Thread-1  ]: Acquiring new postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:55:55.477028 [debug] [Thread-1  ]: Began compiling node model.airbyte_rewards.my_second_dbt_model
09:55:55.477286 [debug] [Thread-1  ]: Compiling model.airbyte_rewards.my_second_dbt_model
09:55:55.481697 [debug] [Thread-1  ]: Writing injected SQL for node "model.airbyte_rewards.my_second_dbt_model"
09:55:55.482673 [debug] [Thread-1  ]: finished collecting timing info
09:55:55.482913 [debug] [Thread-1  ]: Began executing node model.airbyte_rewards.my_second_dbt_model
09:55:55.509795 [debug] [Thread-1  ]: Writing runtime SQL for node "model.airbyte_rewards.my_second_dbt_model"
09:55:55.510403 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:55:55.510570 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: BEGIN
09:55:55.510699 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:55:55.813169 [debug] [Thread-1  ]: SQL status: BEGIN in 0.3 seconds
09:55:55.814184 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:55:55.814841 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_second_dbt_model"} */

  create view "rewards"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "rewards"."public"."my_first_dbt_model"
where id = 1
  );
09:55:55.846389 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.03 seconds
09:55:55.853717 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:55:55.854117 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_second_dbt_model"} */
alter table "rewards"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
09:55:55.886722 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
09:55:55.889822 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: COMMIT
09:55:55.890236 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:55:55.890544 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: COMMIT
09:55:55.923630 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
09:55:55.928218 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.my_second_dbt_model"
09:55:55.928667 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.my_second_dbt_model"} */
drop view if exists "rewards"."public"."my_second_dbt_model__dbt_backup" cascade
09:55:55.957164 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.03 seconds
09:55:55.960817 [debug] [Thread-1  ]: finished collecting timing info
09:55:55.961069 [debug] [Thread-1  ]: On model.airbyte_rewards.my_second_dbt_model: Close
09:55:55.961534 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62b56425-226d-40fc-9cac-6d9fca188305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0f8235f90>]}
09:55:55.961864 [info ] [Thread-1  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.48s]
09:55:55.962186 [debug] [Thread-1  ]: Finished running node model.airbyte_rewards.my_second_dbt_model
09:55:56.036055 [debug] [MainThread]: Acquiring new postgres connection "master"
09:55:56.037017 [debug] [MainThread]: Using postgres connection "master"
09:55:56.037393 [debug] [MainThread]: On master: BEGIN
09:55:56.037744 [debug] [MainThread]: Opening a new connection, currently in state closed
09:55:56.334279 [debug] [MainThread]: SQL status: BEGIN in 0.3 seconds
09:55:56.334817 [debug] [MainThread]: On master: COMMIT
09:55:56.335011 [debug] [MainThread]: Using postgres connection "master"
09:55:56.335185 [debug] [MainThread]: On master: COMMIT
09:55:56.362535 [debug] [MainThread]: SQL status: COMMIT in 0.03 seconds
09:55:56.362829 [debug] [MainThread]: On master: Close
09:55:56.363697 [info ] [MainThread]: 
09:55:56.364162 [info ] [MainThread]: Finished running 2 table models, 1 view model in 4.75s.
09:55:56.364566 [debug] [MainThread]: Connection 'master' was properly closed.
09:55:56.364793 [debug] [MainThread]: Connection 'model.airbyte_rewards.my_second_dbt_model' was properly closed.
09:55:56.374084 [info ] [MainThread]: 
09:55:56.374457 [info ] [MainThread]: [32mCompleted successfully[0m
09:55:56.374816 [info ] [MainThread]: 
09:55:56.375396 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
09:55:56.375825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e8097fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e8912b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e8912a50>]}


============================== 2022-07-07 10:03:55.203633 | 3b05407a-7b9d-4c92-ac17-a31565d89e31 ==============================
10:03:55.203822 [info ] [MainThread]: Running with dbt=1.1.1
10:03:55.204712 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rashmimishra/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
10:03:55.204854 [debug] [MainThread]: Tracking: tracking
10:03:55.242454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb792010410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb792010350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb792010850>]}
10:03:55.270637 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 1 files added, 1 files changed.
10:03:55.270975 [debug] [MainThread]: Partial parsing: added file: airbyte_rewards://models/example/rewards_users.sql
10:03:55.271308 [debug] [MainThread]: Partial parsing: update schema file: airbyte_rewards://models/example/schema.yml
10:03:55.271433 [debug] [MainThread]: Partial parsing: deleted file: airbyte_rewards://models/example/my_first_dbt_model.sql
10:03:55.271533 [debug] [MainThread]: Partial parsing: deleted file: airbyte_rewards://models/example/my_second_dbt_model.sql
10:03:55.271631 [debug] [MainThread]: Partial parsing: deleted file: airbyte_rewards://models/example/rewards_db.sql
10:03:55.303845 [debug] [MainThread]: 1699: static parser successfully parsed example/rewards_users.sql
10:03:55.351447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b05407a-7b9d-4c92-ac17-a31565d89e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7a0912f50>]}
10:03:55.356227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b05407a-7b9d-4c92-ac17-a31565d89e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79215a0d0>]}
10:03:55.356474 [info ] [MainThread]: Found 1 model, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
10:03:55.356695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b05407a-7b9d-4c92-ac17-a31565d89e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7920e5f90>]}
10:03:55.357726 [info ] [MainThread]: 
10:03:55.358081 [debug] [MainThread]: Acquiring new postgres connection "master"
10:03:55.358737 [debug] [ThreadPool]: Acquiring new postgres connection "list_rewards"
10:03:55.367843 [debug] [ThreadPool]: Using postgres connection "list_rewards"
10:03:55.368053 [debug] [ThreadPool]: On list_rewards: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "list_rewards"} */

    select distinct nspname from pg_namespace
  
10:03:55.368164 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:03:56.068271 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.7 seconds
10:03:56.075543 [debug] [ThreadPool]: On list_rewards: Close
10:03:56.078317 [debug] [ThreadPool]: Acquiring new postgres connection "list_rewards_public"
10:03:56.089916 [debug] [ThreadPool]: Using postgres connection "list_rewards_public"
10:03:56.090202 [debug] [ThreadPool]: On list_rewards_public: BEGIN
10:03:56.090403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:03:56.678490 [debug] [ThreadPool]: SQL status: BEGIN in 0.59 seconds
10:03:56.680270 [debug] [ThreadPool]: Using postgres connection "list_rewards_public"
10:03:56.681665 [debug] [ThreadPool]: On list_rewards_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "list_rewards_public"} */
select
      'rewards' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'rewards' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
10:03:56.730121 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.05 seconds
10:03:56.737694 [debug] [ThreadPool]: On list_rewards_public: ROLLBACK
10:03:56.917877 [debug] [ThreadPool]: On list_rewards_public: Close
10:03:56.935384 [debug] [MainThread]: Using postgres connection "master"
10:03:56.935773 [debug] [MainThread]: On master: BEGIN
10:03:56.935984 [debug] [MainThread]: Opening a new connection, currently in state init
10:03:57.374913 [debug] [MainThread]: SQL status: BEGIN in 0.44 seconds
10:03:57.376574 [debug] [MainThread]: Using postgres connection "master"
10:03:57.377225 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
10:03:57.417097 [debug] [MainThread]: SQL status: SELECT 1 in 0.04 seconds
10:03:57.423126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b05407a-7b9d-4c92-ac17-a31565d89e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb792224650>]}
10:03:57.423880 [debug] [MainThread]: On master: ROLLBACK
10:03:57.461593 [debug] [MainThread]: Using postgres connection "master"
10:03:57.462577 [debug] [MainThread]: On master: BEGIN
10:03:57.551565 [debug] [MainThread]: SQL status: BEGIN in 0.09 seconds
10:03:57.552702 [debug] [MainThread]: On master: COMMIT
10:03:57.553350 [debug] [MainThread]: Using postgres connection "master"
10:03:57.553952 [debug] [MainThread]: On master: COMMIT
10:03:57.585902 [debug] [MainThread]: SQL status: COMMIT in 0.03 seconds
10:03:57.587102 [debug] [MainThread]: On master: Close
10:03:57.589520 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
10:03:57.590893 [info ] [MainThread]: 
10:03:57.595109 [debug] [Thread-1  ]: Began running node model.airbyte_rewards.rewards_users
10:03:57.595640 [info ] [Thread-1  ]: 1 of 1 START table model public.rewards_users .................................. [RUN]
10:03:57.596426 [debug] [Thread-1  ]: Acquiring new postgres connection "model.airbyte_rewards.rewards_users"
10:03:57.596702 [debug] [Thread-1  ]: Began compiling node model.airbyte_rewards.rewards_users
10:03:57.597008 [debug] [Thread-1  ]: Compiling model.airbyte_rewards.rewards_users
10:03:57.602672 [debug] [Thread-1  ]: Writing injected SQL for node "model.airbyte_rewards.rewards_users"
10:03:57.603835 [debug] [Thread-1  ]: finished collecting timing info
10:03:57.604146 [debug] [Thread-1  ]: Began executing node model.airbyte_rewards.rewards_users
10:03:57.639508 [debug] [Thread-1  ]: Writing runtime SQL for node "model.airbyte_rewards.rewards_users"
10:03:57.640269 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_users"
10:03:57.640417 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_users: BEGIN
10:03:57.640537 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:03:58.091911 [debug] [Thread-1  ]: SQL status: BEGIN in 0.45 seconds
10:03:58.092258 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_users"
10:03:58.092406 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_users: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.rewards_users"} */


  create  table "rewards"."public"."rewards_users__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- with source_data as (

--     select 1 as id
--     union all
--     select null as id

-- )

select
  id, user_id, first_name, last_name, email, contact, gender, to_timestamp(dob) as dob, location, latitude, longitude, work_status, preferred_languages, is_mother, family_type, interests, durables, to_timestamp(created_time) as created_time, to_timestamp(updated_time) as updated_time, is_deleted, profession_type, income_slab, device_details, is_email_verified, referral_code, referred_by, state_name, is_email_invalid, is_rewards_disabled, rewards_app_login, is_expecting, helpdesk_membership_id, city, user_tags, rfm_cluster_score
from users

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
10:03:59.158262 [debug] [Thread-1  ]: SQL status: SELECT 285878 in 1.07 seconds
10:03:59.164103 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_users"
10:03:59.164269 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_users: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.rewards_users"} */
alter table "rewards"."public"."rewards_users__dbt_tmp" rename to "rewards_users"
10:03:59.444854 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.28 seconds
10:03:59.467387 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_users: COMMIT
10:03:59.467734 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_users"
10:03:59.467919 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_users: COMMIT
10:03:59.518080 [debug] [Thread-1  ]: SQL status: COMMIT in 0.05 seconds
10:03:59.528199 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_users"
10:03:59.528441 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_users: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.rewards_users"} */
drop table if exists "rewards"."public"."rewards_users__dbt_backup" cascade
10:03:59.577461 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.05 seconds
10:03:59.580562 [debug] [Thread-1  ]: finished collecting timing info
10:03:59.580987 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_users: Close
10:03:59.581959 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b05407a-7b9d-4c92-ac17-a31565d89e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7700b3a90>]}
10:03:59.582730 [info ] [Thread-1  ]: 1 of 1 OK created table model public.rewards_users ............................. [[32mSELECT 285878[0m in 1.99s]
10:03:59.583849 [debug] [Thread-1  ]: Finished running node model.airbyte_rewards.rewards_users
10:03:59.676422 [debug] [MainThread]: Acquiring new postgres connection "master"
10:03:59.677131 [debug] [MainThread]: Using postgres connection "master"
10:03:59.677408 [debug] [MainThread]: On master: BEGIN
10:03:59.677630 [debug] [MainThread]: Opening a new connection, currently in state closed
10:04:00.182063 [debug] [MainThread]: SQL status: BEGIN in 0.5 seconds
10:04:00.183926 [debug] [MainThread]: On master: COMMIT
10:04:00.184599 [debug] [MainThread]: Using postgres connection "master"
10:04:00.185220 [debug] [MainThread]: On master: COMMIT
10:04:00.220703 [debug] [MainThread]: SQL status: COMMIT in 0.03 seconds
10:04:00.221870 [debug] [MainThread]: On master: Close
10:04:00.224552 [info ] [MainThread]: 
10:04:00.225630 [info ] [MainThread]: Finished running 1 table model in 4.87s.
10:04:00.226229 [debug] [MainThread]: Connection 'master' was properly closed.
10:04:00.226522 [debug] [MainThread]: Connection 'model.airbyte_rewards.rewards_users' was properly closed.
10:04:00.237539 [info ] [MainThread]: 
10:04:00.238100 [info ] [MainThread]: [32mCompleted successfully[0m
10:04:00.238536 [info ] [MainThread]: 
10:04:00.239096 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
10:04:00.239777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7700aed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79225a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79225ac90>]}


============================== 2022-07-07 10:19:03.543237 | 3b13efa0-1ee7-40dd-8904-6583dd18da8e ==============================
10:19:03.543282 [info ] [MainThread]: Running with dbt=1.1.1
10:19:03.544150 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rashmimishra/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
10:19:03.544275 [debug] [MainThread]: Tracking: tracking
10:19:03.576435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10effc820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10effc700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10effc6d0>]}
10:19:03.603616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
10:19:03.603777 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
10:19:03.608290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b13efa0-1ee7-40dd-8904-6583dd18da8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0ecfd0>]}
10:19:03.612441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b13efa0-1ee7-40dd-8904-6583dd18da8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f059910>]}
10:19:03.612615 [info ] [MainThread]: Found 1 model, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
10:19:03.612778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b13efa0-1ee7-40dd-8904-6583dd18da8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0599d0>]}
10:19:03.613826 [info ] [MainThread]: 
10:19:03.614150 [debug] [MainThread]: Acquiring new postgres connection "master"
10:19:03.614753 [debug] [ThreadPool]: Acquiring new postgres connection "list_rewards"
10:19:03.621619 [debug] [ThreadPool]: Using postgres connection "list_rewards"
10:19:03.621844 [debug] [ThreadPool]: On list_rewards: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "list_rewards"} */

    select distinct nspname from pg_namespace
  
10:19:03.621944 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:19:03.970279 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.35 seconds
10:19:03.971800 [debug] [ThreadPool]: On list_rewards: Close
10:19:03.972704 [debug] [ThreadPool]: Acquiring new postgres connection "list_rewards_public"
10:19:03.976692 [debug] [ThreadPool]: Using postgres connection "list_rewards_public"
10:19:03.976881 [debug] [ThreadPool]: On list_rewards_public: BEGIN
10:19:03.976963 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:19:04.268942 [debug] [ThreadPool]: SQL status: BEGIN in 0.29 seconds
10:19:04.270568 [debug] [ThreadPool]: Using postgres connection "list_rewards_public"
10:19:04.271167 [debug] [ThreadPool]: On list_rewards_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "list_rewards_public"} */
select
      'rewards' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'rewards' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
10:19:04.337946 [debug] [ThreadPool]: SQL status: SELECT 88 in 0.07 seconds
10:19:04.346318 [debug] [ThreadPool]: On list_rewards_public: ROLLBACK
10:19:04.383652 [debug] [ThreadPool]: On list_rewards_public: Close
10:19:04.396878 [debug] [MainThread]: Using postgres connection "master"
10:19:04.397158 [debug] [MainThread]: On master: BEGIN
10:19:04.397347 [debug] [MainThread]: Opening a new connection, currently in state init
10:19:04.929505 [debug] [MainThread]: SQL status: BEGIN in 0.53 seconds
10:19:04.930791 [debug] [MainThread]: Using postgres connection "master"
10:19:04.931072 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
10:19:04.967488 [debug] [MainThread]: SQL status: SELECT 1 in 0.04 seconds
10:19:04.971722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b13efa0-1ee7-40dd-8904-6583dd18da8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f000820>]}
10:19:04.972671 [debug] [MainThread]: On master: ROLLBACK
10:19:05.003676 [debug] [MainThread]: Using postgres connection "master"
10:19:05.004414 [debug] [MainThread]: On master: BEGIN
10:19:05.075999 [debug] [MainThread]: SQL status: BEGIN in 0.07 seconds
10:19:05.076855 [debug] [MainThread]: On master: COMMIT
10:19:05.077161 [debug] [MainThread]: Using postgres connection "master"
10:19:05.077424 [debug] [MainThread]: On master: COMMIT
10:19:05.105283 [debug] [MainThread]: SQL status: COMMIT in 0.03 seconds
10:19:05.106106 [debug] [MainThread]: On master: Close
10:19:05.107845 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
10:19:05.108543 [info ] [MainThread]: 
10:19:05.117786 [debug] [Thread-1  ]: Began running node model.airbyte_rewards.rewards_users
10:19:05.118447 [info ] [Thread-1  ]: 1 of 1 START table model public.rewards_users .................................. [RUN]
10:19:05.119210 [debug] [Thread-1  ]: Acquiring new postgres connection "model.airbyte_rewards.rewards_users"
10:19:05.119453 [debug] [Thread-1  ]: Began compiling node model.airbyte_rewards.rewards_users
10:19:05.119707 [debug] [Thread-1  ]: Compiling model.airbyte_rewards.rewards_users
10:19:05.124418 [debug] [Thread-1  ]: Writing injected SQL for node "model.airbyte_rewards.rewards_users"
10:19:05.125802 [debug] [Thread-1  ]: finished collecting timing info
10:19:05.126164 [debug] [Thread-1  ]: Began executing node model.airbyte_rewards.rewards_users
10:19:05.155903 [debug] [Thread-1  ]: Writing runtime SQL for node "model.airbyte_rewards.rewards_users"
10:19:05.156457 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_users"
10:19:05.156570 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_users: BEGIN
10:19:05.156660 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:19:05.693985 [debug] [Thread-1  ]: SQL status: BEGIN in 0.54 seconds
10:19:05.695531 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_users"
10:19:05.695838 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_users: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.rewards_users"} */


  create  table "rewards"."public"."rewards_users__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- with source_data as (

--     select 1 as id
--     union all
--     select null as id

-- )

select
  id, user_id, first_name, last_name, email, contact, gender, to_timestamp(dob) as dob, location, latitude, longitude, work_status, preferred_languages, is_mother, family_type, interests, durables, to_timestamp(created_time) as created_time, to_timestamp(updated_time) as updated_time, is_deleted, profession_type, income_slab, device_details, is_email_verified, referral_code, referred_by, state_name, is_email_invalid, is_rewards_disabled, rewards_app_login, is_expecting, helpdesk_membership_id, city, user_tags, rfm_cluster_score
from users

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
10:19:06.632573 [debug] [Thread-1  ]: SQL status: SELECT 285880 in 0.94 seconds
10:19:06.637208 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_users"
10:19:06.637334 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_users: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.rewards_users"} */
alter table "rewards"."public"."rewards_users" rename to "rewards_users__dbt_backup"
10:19:06.667783 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
10:19:06.669429 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_users"
10:19:06.669546 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_users: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.rewards_users"} */
alter table "rewards"."public"."rewards_users__dbt_tmp" rename to "rewards_users"
10:19:06.699404 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
10:19:06.708548 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_users: COMMIT
10:19:06.708689 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_users"
10:19:06.708796 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_users: COMMIT
10:19:06.795775 [debug] [Thread-1  ]: SQL status: COMMIT in 0.09 seconds
10:19:06.801675 [debug] [Thread-1  ]: Using postgres connection "model.airbyte_rewards.rewards_users"
10:19:06.801874 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_users: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "airbyte_rewards", "target_name": "dev", "node_id": "model.airbyte_rewards.rewards_users"} */
drop table if exists "rewards"."public"."rewards_users__dbt_backup" cascade
10:19:07.352280 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.55 seconds
10:19:07.353339 [debug] [Thread-1  ]: finished collecting timing info
10:19:07.353465 [debug] [Thread-1  ]: On model.airbyte_rewards.rewards_users: Close
10:19:07.354037 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b13efa0-1ee7-40dd-8904-6583dd18da8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f84cc10>]}
10:19:07.354345 [info ] [Thread-1  ]: 1 of 1 OK created table model public.rewards_users ............................. [[32mSELECT 285880[0m in 2.24s]
10:19:07.354697 [debug] [Thread-1  ]: Finished running node model.airbyte_rewards.rewards_users
10:19:07.355722 [debug] [MainThread]: Acquiring new postgres connection "master"
10:19:07.355871 [debug] [MainThread]: Using postgres connection "master"
10:19:07.355957 [debug] [MainThread]: On master: BEGIN
10:19:07.356032 [debug] [MainThread]: Opening a new connection, currently in state closed
10:19:07.893654 [debug] [MainThread]: SQL status: BEGIN in 0.54 seconds
10:19:07.894177 [debug] [MainThread]: On master: COMMIT
10:19:07.894375 [debug] [MainThread]: Using postgres connection "master"
10:19:07.894548 [debug] [MainThread]: On master: COMMIT
10:19:07.927320 [debug] [MainThread]: SQL status: COMMIT in 0.03 seconds
10:19:07.928156 [debug] [MainThread]: On master: Close
10:19:07.930872 [info ] [MainThread]: 
10:19:07.931757 [info ] [MainThread]: Finished running 1 table model in 4.32s.
10:19:07.932249 [debug] [MainThread]: Connection 'master' was properly closed.
10:19:07.932459 [debug] [MainThread]: Connection 'model.airbyte_rewards.rewards_users' was properly closed.
10:19:07.942742 [info ] [MainThread]: 
10:19:07.943219 [info ] [MainThread]: [32mCompleted successfully[0m
10:19:07.943574 [info ] [MainThread]: 
10:19:07.943829 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
10:19:07.944248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0cc040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0cc070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0ccb80>]}
